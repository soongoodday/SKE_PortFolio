/* ==========================
   FINAL CSS (복붙용)
   - Stage 공통 폭/패딩 통일
   - Hero(비디오 contain) + HUD 1200↓ 숨김
   - 모바일(iOS) 안전영역/100svh 대응
   - OW Modal / Lightbox 포함
========================== */

/* ==========================
   RESET & BASE
========================== */
*{ margin:0; padding:0; box-sizing:border-box; }

:root{
  --neon-blue:#00F0FF;
  --neon-purple:#9D00FF;
  --neon-pink:#FF006E;
  --neon-green:#39FF14;

  --dark-bg:#07070D;
  --dark-surface:#11111A;
  --dark-card:#161622;
  --dark-border:#2A2A35;

  --light-gray:#8B8B9A;
  --lighter-gray:#B8B8C7;
  --white:#FFFFFF;

  --font-display:'Orbitron',sans-serif;
  --font-body:'Inter',sans-serif;
  --font-pixel:'Press Start 2P', monospace;
  --font-pixel-kor:'Mulmaru', monospace;

  --space-xs:.5rem;
  --space-sm:1rem;
  --space-md:2rem;
  --space-lg:4rem;
  --space-xl:6rem;
  --space-xxl:10rem;

  --easing:cubic-bezier(0.22,1,0.36,1);
  --mx:.5;
  --my:.5;
  --scroll:0;

  /* ✅ 전체 섹션 컨테이너 기준(Quest Log 폭 기준으로 통일) */
  --stage-max-width: 1400px;
  --stage-padding-x: clamp(16px, 3vw, 28px);

  --ui-accent: var(--neon-blue);
  --ui-accent-soft: rgba(0,240,255,.18);
}

html{
  scroll-behavior:smooth;
  font-size:16px;
  -webkit-text-size-adjust:100%;
}
body{
  font-family:var(--font-body);
  background:
    radial-gradient(1200px 700px at 50% -10%, rgba(0,240,255,.12), transparent 65%),
    radial-gradient(900px 500px at 15% 10%, rgba(157,0,255,.16), transparent 60%),
    radial-gradient(800px 500px at 90% 20%, rgba(255,0,110,.14), transparent 62%),
    var(--dark-bg);
  color:var(--white);
  line-height:1.6;
  overflow-x:hidden;
}
a{ color:inherit; }
button{ font:inherit; }

@font-face {
    font-family: 'NeoDonggeunmo';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.3/NeoDunggeunmo.woff') format('woff');
    font-weight: normal;
    font-display: swap;
}

/* ==========================
   FX
========================== */
.fx{
  position:fixed; inset:0;
  z-index:-3;
  pointer-events:none;
  overflow:hidden;
}
.grid-background{
  position:absolute; inset:0;
  background:
    radial-gradient(1200px 700px at 50% 20%, rgba(0,240,255,.10), transparent 60%),
    linear-gradient(90deg, transparent 0%, rgba(7,7,13,.65) 50%, transparent 100%),
    linear-gradient(0deg, rgba(7,7,13,.85) 0%, #0F0F1A 50%, rgba(7,7,13,.85) 100%);
}
.grid-lines{
  width:100%; height:100%;
  background-image:
    linear-gradient(rgba(42,42,53,0.9) 1px, transparent 1px),
    linear-gradient(90deg, rgba(42,42,53,0.9) 1px, transparent 1px);
  background-size:64px 64px;
  opacity:.12;
  animation:gridMove 34s var(--easing) infinite;
  transform-origin:50% 50%;
  will-change:transform;
}
@keyframes gridMove{
  0%{ transform: perspective(560px) rotateX(62deg) translateZ(0) translateY(0); }
  100%{ transform: perspective(560px) rotateX(62deg) translateZ(26px) translateY(10px); }
}

.fx-noise{
  position:absolute; inset:0;
  opacity:.045;
  mix-blend-mode:overlay;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.6'/%3E%3C/svg%3E");
  background-size:280px 280px;
}

.fx-cursor-glow{
  position:absolute;
  width:460px; height:460px;
  transform:translate(-50%,-50%);
  border-radius:50%;
  background:radial-gradient(circle, rgba(0,240,255,.14) 0%, rgba(157,0,255,.08) 32%, transparent 72%);
  opacity:0;
  transition:opacity .35s ease, transform .12s linear;
  will-change:transform;
}

/* mouse follower */
#fxFollower{
  position:fixed; left:0; top:0;
  z-index:5;
  pointer-events:none;
  filter: drop-shadow(0 0 18px rgba(0,240,255,.35));
  will-change:transform;
}
#fxFollower img{ width:140px; height:auto; }

/* FX는 전부 클릭 막지 않게 */
.fx, .fx *{ pointer-events:none !important; }

/* header */
.header{
  height: auto;
  overflow: visible;
}

/* ==========================
   NAV
========================== */
.main-nav{
  position:fixed;
  top:0; left:0; right:0;
  z-index:1000;
  height: 62px;

  background:rgba(10,10,15,.76);
  backdrop-filter:blur(18px);
  border-bottom:1px solid rgba(42,42,53,.75);
}
.nav-container{
  max-width: 1520px;
  margin: 0 auto;
  padding: 12px 280px; /* ⭐ 고정 170 대신 유동 */
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  column-gap: 24px;
}
.nav-logo{ text-decoration:none; }
.logo-text{
  font-family:var(--font-pixel);
  font-size:1.1rem;
  font-weight:800;
  background:linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  display: none;
}
.nav-menu{ 
  display:flex; 
  list-style:none; 
  gap:var(--space-lg);
  overflow-y: hidden;
}

.nav-menu a{
  font-family: var(--font-pixel-kor), var(--font-body), sans-serif;
  text-decoration:none;
  color:var(--lighter-gray);
  font-size:.8rem;
  font-weight:600;
  letter-spacing:.12em;
  position:relative;
  transition:all .25s ease;
}

.nav-menu a:hover{ color:var(--white); text-shadow:0 0 18px rgba(0,240,255,.35); }

/* 클릭 후 유지되는 상태 */
.nav-menu a.is-active{
  color: var(--neon-blue);
  text-shadow: 0 0 18px rgba(0,240,255,.35);
}

/* 선택된 상태에서 hover해도 유지 */
.nav-menu a.is-active:hover{
  color: var(--neon-blue);
  text-shadow:0 0 18px rgba(0,240,255,.35);
}
.nav-cta{
  padding:10px 16px;
  border-radius:12px;
  background:rgba(10,10,15,.45);
  border:1px solid rgba(0,240,255,.35);
  color:rgba(255,255,255,.92);
  cursor:pointer;
  transition:transform .25s var(--easing), border-color .25s var(--easing), box-shadow .25s var(--easing);
  font-family:var(--font-pixel);
  font-size:12px;
  letter-spacing:.1em;
}
.nav-cta:hover{
  transform:translateY(-2px);
  border-color:rgba(0,240,255,.75);
  box-shadow:0 22px 90px rgba(0,240,255,.12);
}

/* ==========================
   SECTIONS (공통 폭/패딩 통일)
========================== */
section{
  position:relative;
  padding: var(--space-xxl) 0;
}
.section-number{
  position:absolute;
  top:var(--space-xl);
  left:var(--stage-padding-x);
  font-family:var(--font-display);
  font-size:.95rem;
  color:var(--neon-purple);
  font-weight:700;
  letter-spacing:.2em;
  opacity:.9;
}

/* ✅ 공통 컨테이너(섹션 안의 내용 폭 맞추기) */
.section-header,
.character-layout,
.skilltree-layout,
.quest-layout,
.ending{
  width:100%;
  max-width: var(--stage-max-width);
  margin-left:auto;
  margin-right:auto;
  padding-left: var(--stage-padding-x);
  padding-right: var(--stage-padding-x);
}

.section-header{ margin:0 auto var(--space-xl); }
.section-header.center{ text-align:center; }

.section-title{
  font-family:var(--font-display);
  font-size:clamp(2.6rem, 7vw, 5.4rem);
  font-weight:900;
  line-height:1;
  margin-bottom:var(--space-md);
  display:inline-block;
  position:relative;
}
.glitch{ animation:glitchText 5s infinite; }
.glitch::before,.glitch::after{
  content:attr(data-text);
  position:absolute; top:0; left:0;
  width:100%; height:100%;
}
.glitch::before{
  color:var(--neon-blue);
  animation:glitch1 2.5s infinite;
  clip-path:polygon(0 0, 100% 0, 100% 45%, 0 45%);
}
.glitch::after{
  color:var(--neon-pink);
  animation:glitch2 2.5s infinite;
  clip-path:polygon(0 55%, 100% 55%, 100% 100%, 0 100%);
}
@keyframes glitchText{
  0%,90%,100%{ transform:translate(0); }
  20%,60%{ transform:translate(-2px,2px); }
  40%,80%{ transform:translate(2px,-2px); }
}
@keyframes glitch1{ 0%,90%,100%{transform:translate(0);} 20%{transform:translate(-5px,3px);} }
@keyframes glitch2{ 0%,90%,100%{transform:translate(0);} 60%{transform:translate(5px,-3px);} }

.title-line{
  width:120px; height:3px;
  background:linear-gradient(90deg, var(--neon-purple), transparent);
  margin-top:var(--space-md);
}
.section-subtitle{ font-family: 'NeoDonggeunmo'; color:var(--light-gray); font-size:1.05rem; margin-top:var(--space-md); }

/* ==========================
   HERO (FINAL)
========================== */
.hero{
  /* ✅ iOS 주소창 변화 대응 */
  min-height: 100svh;
  display:flex;
  align-items:center;

  /* ✅ NAV 높이만큼 상단 여백 */
  padding:
    calc(var(--space-xxl) + 72px + env(safe-area-inset-top))
    var(--stage-padding-x)
    var(--space-xxl);

  position: relative;
  overflow:hidden;
}

/* background layers */
.hero-bg{ position:absolute; inset:0; z-index:0; pointer-events:none; }
.hero-video{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit: contain;            /* ✅ 안 잘리게 */
  object-position:center;
  background:#05070b;
  filter:saturate(1.05) contrast(1.05);
  transform:none;
  z-index:0;
}
.hero-video-overlay{ position:absolute; inset:0; z-index:1;
  background:
    radial-gradient(60% 60% at 50% 40%, rgba(0,0,0,.15), rgba(0,0,0,.75)),
    linear-gradient(to bottom, rgba(0,0,0,.15), rgba(0,0,0,.85));
}
.hero-scanlines{
  position:absolute; inset:0; z-index:2;
  background:repeating-linear-gradient(to bottom, rgba(255,255,255,.045) 0px, rgba(255,255,255,.045) 1px, rgba(0,0,0,0) 3px, rgba(0,0,0,0) 6px);
  opacity:.26;
  mix-blend-mode:overlay;
  pointer-events:none;
  animation:scanMove 8s linear infinite;
}
@keyframes scanMove{ 0%{transform:translateY(0);} 100%{transform:translateY(24px);} }

.hero-glitch{
  position:absolute; inset:0; z-index:3;
  background:linear-gradient(90deg, rgba(0,240,255,.06), transparent 30%, rgba(157,0,255,.05));
  opacity:0;
  mix-blend-mode:screen;
  filter:blur(10px);
  pointer-events:none;
}
.hero.cyber-glitch .hero-glitch{ opacity:.55; }

/* vignette(가독성) */
.hero::before{
  content:'';
  position:absolute;
  inset:0;
  z-index:4;
  background: radial-gradient(ellipse at center,
    rgba(5,7,11,0.18) 0%,
    rgba(5,7,11,0.88) 72%,
    #05070b 100%
  );
  pointer-events:none;
}

/* layout */
.hero-layout{
  position:relative;
  z-index:5;
  width: fit-content; 
  display:grid;
  grid-template-columns: minmax(720px, 900px) 320px;
  gap:32px;
  align-items:start;
  min-height:70vh;
  margin: 0 auto;
}

/* card */
.hero-container{
  position:relative;
  z-index:2;
  width:100%;
  text-align:center;

  border-radius:20px;
  padding:48px 32px;

  background: rgba(5,7,11,.58);
  border:1px solid rgba(255,255,255,.12);
  backdrop-filter:blur(16px);
  box-shadow:0 26px 120px rgba(0,0,0,.35);
  overflow:visible;
  transform:translateZ(0);
}

.hero-container::before{
  content:"";
  position:absolute; inset:0;
  background: radial-gradient(120% 80% at 30% 10%, rgba(255,255,255,.10), transparent 55%);
  pointer-events:none;
}

.hero-badge.badge-sign{
  display:inline-flex;
  align-items:center;
  gap:12px;
  padding:10px 16px;
  border-radius:999px;
  background:rgba(10,10,15,.30);
  border:1px solid rgba(255,255,255,.10);
  backdrop-filter:blur(16px);
  margin-bottom:26px;
}
.sign-name{ font-family:var(--font-display); letter-spacing:.18em; font-size:.78rem; color:rgba(255,255,255,.82); }
.sign-dot{
  width:6px; height:6px;
  border-radius:50%;
  background:#3b82f6;
  box-shadow:0 0 14px rgba(157,0,255,.45);
}
.sign-role{ font-size:.76rem; letter-spacing:.16em; color:rgba(255,255,255,.62); }
.sign-year{
  font-size:.72rem;
  letter-spacing:.18em;
  padding:4px 10px;
  border-radius:999px;
  border:1px solid #3b82f6;
  color:rgba(255,255,255,.70);
}

.hero-title{ position:relative; margin-bottom:26px; }
.hero-title::after{
  content:"";
  position:absolute;
  left:10%; right:10%;
  top:52%;
  height:2px;
  background:linear-gradient(90deg, transparent, rgba(0,240,255,.35), transparent);
  opacity:.18;
  filter:blur(.2px);
  pointer-events:none;
}
.hero-title .title-row{
  display:flex;
  align-items:baseline;
  justify-content:center;
  gap:clamp(10px, 1.6vw, 18px);
}
.hero-title .title-pixel{
  font-family:var(--font-pixel);
  font-size:clamp(1.9rem, 4.6vw, 4.3rem);
  line-height:1.22;
  letter-spacing:.02em;
  color:rgba(255,255,255,.96);
  text-shadow:2px 0 rgba(0,240,255,.18), -2px 0 rgba(157,0,255,.16);
  position:relative;
}
.hero-title .title-pixel::before,
.hero-title .title-pixel::after{
  content:attr(data-text);
  position:absolute;
  inset:0;
  opacity:0;
  pointer-events:none;
}
.hero-title .title-pixel::before{ transform:translate(2px,-1px); color:rgba(0,240,255,.85); }
.hero-title .title-pixel::after{ transform:translate(-2px,1px); color:rgba(157,0,255,.80); }
.hero-title .title-pixel.glitch-on::before,
.hero-title .title-pixel.glitch-on::after{
  opacity:1;
  animation:miniGlitch .9s steps(3,end) 1;
}
@keyframes miniGlitch{
  0%{ clip-path: inset(0 0 78% 0); transform: translate(2px,-1px); }
  18%{ clip-path: inset(10% 0 55% 0); transform: translate(4px,-2px); }
  38%{ clip-path: inset(40% 0 25% 0); transform: translate(-3px,2px); }
  62%{ clip-path: inset(55% 0 10% 0); transform: translate(3px,1px); }
  100%{ clip-path: inset(78% 0 0 0); transform: translate(-2px,1px); }
}

.hero-description{
  font-family: 'NeoDonggeunmo';
  font-size:1.05rem;
  line-height:1.9;
  max-width:640px;
  margin:0 auto 18px;
  color:rgba(255,255,255,.72);
  text-shadow:0 2px 12px rgba(0,0,0,.55);
}

.hero-typing{
  margin-top:18px;
  text-align:center;
  font-family:var(--font-pixel);
  font-size:13px;
  letter-spacing:.14em;
  color:rgba(0,240,255,.85);
  text-shadow:0 0 14px rgba(0,240,255,.35);
}
.typing-caret{ margin-left:6px; animation:caretBlink .8s steps(2,end) infinite; }
@keyframes caretBlink{ 0%,49%{opacity:1;} 50%,100%{opacity:0;} }

/* PRESS START */
.hero-cta{ display:flex; justify-content:center; margin:26px 0 10px; }
.press-start{
  position:relative;
  border:1px solid rgba(0,240,255,.35);
  background:rgba(10,10,15,.45);
  backdrop-filter:blur(14px);
  border-radius:14px;
  padding:14px 18px;
  cursor:pointer;
  overflow:hidden;
  box-shadow:0 18px 70px rgba(0,0,0,.35);
  transition:transform .25s var(--easing), border-color .25s var(--easing), box-shadow .25s var(--easing);
}
.press-start:hover{
  transform:translateY(-3px);
  border-color:rgba(0,240,255,.75);
  box-shadow:0 22px 90px rgba(0,240,255,.12);
}
.press-start.is-pressed{ transform:translateY(1px) scale(.99); }
.press-start:active{ transform:translateY(1px) scale(.98); }
.press-start::before{
  content:"";
  position:absolute; inset:-2px;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,.06) 0px,
    rgba(255,255,255,.06) 1px,
    transparent 3px,
    transparent 6px
  );
  opacity:.08;
  pointer-events:none;
}
.press-start::after{
  content:"";
  position:absolute; inset:0;
  background:linear-gradient(110deg, transparent 0%, rgba(255,255,255,.12) 35%, rgba(0,240,255,.18) 45%, transparent 55%);
  transform:translateX(-120%) skewX(-18deg);
  opacity:.65;
  animation:pressSweep 2.8s var(--easing) infinite;
  pointer-events:none;
}
@keyframes pressSweep{
  0%{ transform:translateX(-120%) skewX(-18deg); opacity:0; }
  15%{ opacity:.65; }
  100%{ transform:translateX(220%) skewX(-18deg); opacity:0; }
}
.ps-text{
  display:block;
  font-family:var(--font-pixel);
  font-size:14px;
  letter-spacing:.12em;
  color:rgba(255,255,255,.92);
  text-shadow:3px 0 rgba(0,240,255,.18), -3px 0 rgba(157,0,255,.16);
}

/* HUD */
.hero-hud{
  position:relative;
  width:320px;
  max-width:100%;
  overflow:hidden;
  height: min(560px, 72vh);
  display:flex;
  flex-direction:column;
  pointer-events:auto !important;

  border-radius:14px;
  border:1px solid rgba(0,240,255,.22);
  background:
    radial-gradient(120% 140% at 20% 0%, rgba(0,240,255,.10), transparent 50%),
    radial-gradient(120% 140% at 80% 10%, rgba(157,0,255,.10), transparent 55%),
    rgba(8,10,14,.55);

  box-shadow:
    0 30px 120px rgba(0,0,0,.55),
    inset 0 0 0 1px rgba(255,255,255,.06),
    inset 0 0 40px rgba(0,240,255,.06);

  transform: perspective(900px) rotateY(-2.5deg) rotateX(1.2deg);
}
.hero-hud::before{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,.05) 0px,
    rgba(255,255,255,.05) 1px,
    transparent 3px,
    transparent 6px
  );
  opacity:.10;
  animation:hudScan 7s linear infinite;
}
@keyframes hudScan{ 0%{transform:translateY(0);} 100%{transform:translateY(24px);} }
.hero-hud::after{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  mix-blend-mode:screen;
  background: linear-gradient(90deg,
    rgba(0,240,255,.10), transparent 20%,
    transparent 80%, rgba(255,0,110,.08)
  );
  opacity:.35;
}

/* HUD top */
.hud-top{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:12px 14px;
  border-bottom:1px solid rgba(255,255,255,.08);
  font-family:var(--font-pixel);
  font-size:10px;
  letter-spacing:.12em;
  position:relative;
  z-index:1;
}
.hud-label{ color:rgba(255,255,255,.65); }
.hud-status{ color:rgba(0,240,255,.85); display:flex; align-items:center; gap:8px; }
.hud-status .dot{
  width:8px; height:8px; border-radius:50%;
  background:rgba(0,240,255,.9);
  box-shadow:0 0 14px rgba(0,240,255,.5);
  animation:hudBlink 1.6s ease-in-out infinite;
}
@keyframes hudBlink{ 0%,100%{opacity:1;} 50%{opacity:.28;} }
.hud-time{ color:rgba(255,255,255,.55); }

/* HUD window: logs + input */
.hero-hud .hud-window{
  display:flex;
  flex-direction:column;
  min-height:0;
  overflow:hidden;
  position:relative;
  z-index:1;
}
.hero-hud .hud-lines{
  min-height:0;
  overflow-y:auto;
  padding:14px 10px 70px;
  display:flex;
  flex-direction:column;
  gap:10px;
  pointer-events:auto !important;
}
.hero-hud .hud-lines::-webkit-scrollbar{ width:6px; }
.hero-hud .hud-lines::-webkit-scrollbar-thumb{
  background:rgba(0,240,255,.25);
  border-radius:999px;
}
.hero-hud .hud-line{
  display:flex;
  gap:10px;
  white-space:normal;
  font-size:12px;
  line-height:1.45;
  color:rgba(255,255,255,.62);
}
.hud-tag{ color:rgba(157,0,255,.78); letter-spacing:.08em; opacity:.75; }
.hud-accent{ color:rgba(0,240,255,.85); }

.hud-line.is-alert{
  padding:8px 10px;
  border-radius:12px;
  background:rgba(157,0,255,.10);
  border:1px solid rgba(157,0,255,.35);
  box-shadow:0 0 26px rgba(157,0,255,.10);
}

/* input */
.hud-input{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 10px;
  border-top:1px solid rgba(255,255,255,.08);
  background:rgba(0,0,0,.18);
  pointer-events:auto !important;
  box-sizing: border-box;
}

/* HUD: sticky input (logs scroll, input stays) */
.hero-hud .hud-input{
  position:sticky;
  bottom:0;
  z-index:2;
  padding-bottom: calc(12px + env(safe-area-inset-bottom));
}

/* iOS: prevent input zoom */
#hudInput{ font-family: 'NeoDonggeunmo'; font-size:16px; }

/* HUD: hide legacy progress UI (if any) */
.hero-hud .hud-progress{ display:none !important; }

.hud-prompt{
  font-family:var(--font-pixel);
  font-size:12px;
  color:rgba(0,240,255,.85);
  opacity:.9;
}
#hudInput{
  flex:1;
  background:transparent;
  border:1px solid rgba(0,240,255,.18);
  border-radius:10px;
  padding:10px 12px;
  color:rgba(255,255,255,.9);
  outline:none;
}
#hudInput::placeholder{ color:rgba(255,255,255,.35); }
.hud-send{
  border:1px solid rgba(0,240,255,.35);
  background:rgba(0,240,255,.08);
  color:rgba(0,240,255,.9);
  padding:10px 12px;
  border-radius:10px;
  cursor:pointer;
  font-family:var(--font-pixel);
  font-size:10px;
  letter-spacing:.12em;
  box-shadow:0 10px 0 rgba(0,240,255,.10);
  transform:translateY(0);
}
.hud-send:hover{
  border-color:rgba(0,240,255,.55);
  box-shadow:0 0 18px rgba(0,240,255,.12);
}
.hud-send:active{
  transform:translateY(2px);
  box-shadow:0 6px 0 rgba(0,240,255,.08);
}

.npc-cursor{ display:inline-block; margin-left:2px; animation:npcBlink .9s steps(1) infinite; }
@keyframes npcBlink{ 50%{opacity:0;} }

/* ==========================
   COMMON CARDS
========================== */
[data-tilt]{ transform-style:preserve-3d; will-change:transform; }
.card-corner{
  position:absolute; top:0; right:0;
  width:40px; height:40px;
  border-top:2px solid var(--neon-purple);
  border-right:2px solid var(--neon-purple);
  border-radius:0 16px 0 0;
  opacity:.9;
}
.card-tag{
  display:inline-block;
  font-size:.625rem;
  letter-spacing:.15em;
  color:var(--neon-purple);
  margin-bottom:var(--space-sm);
  font-weight:700;
}

/* ==========================
   STAGE 1: CHARACTER
========================== */
.stage-character{ background:linear-gradient(180deg, rgba(7,7,13,.55) 0%, rgba(17,17,26,.95) 100%); }

.character-layout{
  display:grid;
  grid-template-columns: 2fr 1fr;
  gap:var(--space-xl);
}
.character-card{
  position:relative;
  padding:var(--space-lg);
  border-radius:18px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
  overflow:hidden;
}
.card-title{ font-family:var(--font-display); font-size:2rem; margin-bottom:12px; }
.card-desc{ font-family: 'NeoDonggeunmo'; color:var(--lighter-gray); line-height:1.9; margin-bottom:22px; }

.stat-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
.stat,
.stat2{
  padding:12px 14px;
  border-radius:14px;
  border:1px solid rgba(0,240,255,.18);
  background:rgba(0,240,255,.04);
}
.stat2{
  display:flex;
  justify-content:center;
  align-items:center;
  grid-column:1 / -1;
}
.stat2 img{ width:70%; height:auto; }

.stat-k{
  display:block;
  font-family:var(--font-pixel);
  font-size:10px;
  letter-spacing:.14em;
  color:rgba(255,255,255,.62);
}
.stat-v{
  font-family: 'NeoDonggeunmo';
  display:block;
  margin-top:6px;
  font-weight:700;
  color:rgba(255,255,255,.90);
}
.card-accent{
  position:absolute;
  bottom:-40px; right:-40px;
  width:200px; height:200px;
  background:radial-gradient(circle, rgba(157,0,255,.55), transparent 65%);
  filter:blur(26px);
  opacity:.35;
}

.side-panels{ font-family: 'NeoDonggeunmo'; display:flex; flex-direction:column; gap:var(--space-lg); }
.panel{
  position:relative;
  padding:var(--space-lg);
  border-radius:16px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
}
.panel h3{ font-family: 'NeoDonggeunmo'; font-size:1.5rem; margin-bottom:14px; }
.panel.accent{
  border-color:rgba(157,0,255,.55);
  background:linear-gradient(135deg, rgba(22,22,34,.92), rgba(26,15,46,.80));
}
.panel.dark{
  border-color:rgba(0,240,255,.45);
  background:linear-gradient(180deg, rgba(15,15,26,.92), rgba(10,10,15,.65));
}
.list{ list-style:none; display:flex; flex-direction:column; gap:12px; }
.list li{
  display:flex; justify-content:space-between; gap:12px;
  padding-bottom:10px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.list li:last-child{ border-bottom:none; }
.list li.total b{ color:var(--neon-green); }
.list span{ color:var(--light-gray); }

.badge-list{ list-style:none; display:flex; flex-direction:column; gap:14px; }
.badge-list li{ display:flex; gap:12px; align-items:flex-start; }
.badge{
  padding:.45rem .85rem;
  border-radius:8px;
  font-size:.75rem;
  font-weight:900;
  letter-spacing:.1em;
  white-space:nowrap;
}
.badge.gold{ background:linear-gradient(135deg,#FFD700,#FFA500); color:var(--dark-bg); box-shadow:0 0 20px rgba(255,215,0,.5); }
.badge.bronze{ background:linear-gradient(135deg,#CD7F32,#8B4513); color:var(--white); box-shadow:0 0 20px rgba(205,127,50,.45); }

.certs{ display:flex; flex-direction:column; gap:12px; }
.cert{
  display:flex; align-items:center; gap:12px;
  padding:12px;
  border-radius:12px;
  border:1px solid rgba(0,240,255,.2);
  background:rgba(0,240,255,.05);
}
.cert-icon{
  width:40px; height:40px;
  display:flex; align-items:center; justify-content:center;
  border-radius:12px;
  background:var(--neon-blue);
  color:var(--dark-bg);
  font-weight:900;
  box-shadow:0 0 18px rgba(0,240,255,.55);
}

/* ==========================
   STAGE 2: SKILL TREE
========================== */
.stage-skills{ background:linear-gradient(180deg, rgba(7,7,13,.65) 0%, rgba(15,5,34,.95) 100%); }

.skilltree-layout{
  display:grid;
  grid-template-columns: 1.2fr .8fr;
  gap:var(--space-xl);
}

.tree{
  border-radius:18px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
  overflow:hidden;
}
.tree-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:18px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.tree-title{
  font-family:var(--font-pixel);
  font-size:12px;
  letter-spacing:.14em;
  color:rgba(255,255,255,.85);
}
.tree-sub{ font-family: 'NeoDonggeunmo'; color:rgba(255,255,255,.55); font-size:.9rem; }

.tree-grid{
  padding:18px;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
.node{
  position:relative;
  border-radius:16px;
  border:1px solid rgba(0,240,255,.18);
  background:rgba(0,240,255,.04);
  padding:14px 14px 12px;
  overflow:hidden;
}
.node.locked{
  opacity:.55;
  filter:saturate(.6);
  border-color:rgba(255,255,255,.12);
}
.node-dot{
  width:10px; height:10px;
  border-radius:50%;
  background:rgba(0,240,255,.85);
  box-shadow:0 0 14px rgba(0,240,255,.35);
  position:absolute; top:14px; right:14px;
}
.node.locked .node-dot{ background:rgba(255,255,255,.22); box-shadow:none; }

.node-body b{ font-family:var(--font-display); font-size:1.2rem; }
.node-body span{
  display:block;
  margin-top:6px;
  color:rgba(255,255,255,.62);
  font-size:.9rem;
}
.bar{
  margin-top:12px;
  height:8px;
  border-radius:999px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(0,240,255,.14);
  overflow:hidden;
}
.fill{
  display:block;
  height:100%;
  width:0%;
  background:linear-gradient(90deg, rgba(0,240,255,.85), rgba(157,0,255,.85));
  border-radius:999px;
  transition:width 1.2s var(--easing);
  box-shadow:0 0 18px rgba(0,240,255,.22);
}
.fill.ai{
  background:linear-gradient(90deg, rgba(157,0,255,.85), rgba(255,0,110,.70));
  box-shadow:0 0 18px rgba(157,0,255,.22);
}

.powerup-head{ margin-bottom:16px; }
.powerup-title{
  font-family:var(--font-display);
  letter-spacing:.12em;
  color:var(--neon-purple);
  margin-bottom:6px;
}
.powerup-desc{ font-family: 'NeoDonggeunmo'; color:var(--lighter-gray); }
.power-grid{ display:grid; grid-template-columns:1fr; gap:14px; }
.power-card{
  border-radius:16px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
  padding:16px;
}
.power-top{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
.power-top b{ font-family:var(--font-display); font-size:1.15rem; }
.pct{ font-family:var(--font-display); color:var(--neon-purple); font-weight:900; }
.power-card p{ margin-top:10px; color:var(--lighter-gray); font-size:.9rem; }

/* ==========================
   STAGE 3/4: QUEST LOG
========================== */
.stage-quests{ background:rgba(7,7,13,.65); }

.quest{
  position:relative;
  border-radius:18px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
  padding:22px;
  overflow:hidden;
  cursor:pointer;
  transition:transform .25s var(--easing), border-color .25s var(--easing), box-shadow .25s var(--easing);
}
.quest:hover{
  border-color:rgba(0,240,255,.75);
  transform:translateY(-6px);
  box-shadow:0 20px 60px rgba(0,240,255,.18);
}
.quest-top{
  display:flex;
  justify-content:space-between;
  gap:12px;
  font-family:var(--font-pixel);
  font-size:10px;
  letter-spacing:.12em;
  color:rgba(255,255,255,.70);
  margin-bottom:12px;
}
.quest-title{ font-family: 'NeoDonggeunmo'; font-size:2rem; margin-bottom:10px; }
.quest-desc{ color:var(--lighter-gray); line-height:1.9; }

.quest-tags{ display:flex; flex-wrap:wrap; gap:8px; margin:16px 0; }
.tag{
  padding:.45rem .85rem;
  border-radius:999px;
  font-size:.75rem;
  letter-spacing:.06em;
  color:var(--neon-blue);
  border:1px solid rgba(0,240,255,.30);
  background:rgba(0,240,255,.10);
}
.tag.boss{
  color:var(--white);
  border-color:rgba(157,0,255,.85);
  background:rgba(157,0,255,.85);
  box-shadow:0 0 18px rgba(157,0,255,.35);
}
.quest-btn{
  display:inline-flex;
  align-items:center;
  gap:10px;
  margin-top:8px;
  padding:14px 16px;
  border-radius:14px;
  background:transparent;
  border:2px solid var(--neon-blue);
  color:var(--neon-blue);
  cursor:pointer;
  font-family:var(--font-display);
  letter-spacing:.1em;
  transition:all .25s var(--easing);
}
.quest-btn:hover{
  background:var(--neon-blue);
  color:var(--dark-bg);
  box-shadow:0 0 34px rgba(0,240,255,.75);
  transform:translateX(5px);
}
.quest.featured{ margin-bottom:22px; }
.quest-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(320px,1fr));
  gap:16px;
  margin-top:16px;
}
.quest-meta{ margin-top:10px; color:var(--light-gray); font-size:.85rem; }

/* ==========================
   FINAL
========================== */
.stage-final{ background:rgba(7,7,13,.65); }
.ending{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:var(--space-xl);
  align-items:start;
}
.ending-text{
  position:relative;
  padding:var(--space-lg);
  border-radius:18px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
}
.ending-text h3{ font-family:var(--font-display); font-size:2rem; margin-bottom:12px; }
.ending-text p{ font-family: 'NeoDonggeunmo'; color:var(--lighter-gray); line-height:1.9; }

.ending-ach{ margin-top:18px; padding-top:18px; border-top:1px solid rgba(255,255,255,.08); }
.ach{
  display:block;
  font-family:var(--font-pixel);
  font-size:12px;
  letter-spacing:.12em;
  color:rgba(0,240,255,.85);
}
.ach-sub{ font-family: 'NeoDonggeunmo'; display:block; margin-top:8px; color:rgba(255,255,255,.70); }

.ending-cards{ display:grid; grid-template-columns:1fr; gap:16px; }
.contact-card{
  border-radius:16px;
  border:1px solid rgba(42,42,53,.9);
  background:linear-gradient(180deg, rgba(22,22,34,.92), rgba(17,17,26,.72));
  padding:18px;
  text-decoration:none;
  display:flex;
  flex-direction:column;
  gap:8px;
  transition:transform .25s var(--easing), border-color .25s var(--easing), box-shadow .25s var(--easing);
}
.contact-card:hover{
  border-color:rgba(0,240,255,.75);
  transform:translateY(-6px);
  box-shadow:0 20px 60px rgba(0,240,255,.18);
}
.card-icon{ font-size:2rem; }
.card-label{ font-family: 'NeoDonggeunmo'; font-size:.75rem; letter-spacing:.15em; color:var(--light-gray); }
.card-value{ font-family:var(--font-display); font-size:1.2rem; font-weight:800; }

/* ==========================
   FOOTER + TOP
========================== */
.footer{
  padding:var(--space-lg) var(--stage-padding-x);
  background:rgba(7,7,13,.85);
  border-top:1px solid rgba(42,42,53,.85);
  text-align:center;
  position:relative;
}
.footer-content{
  max-width: var(--stage-max-width);
  margin:0 auto;
}
.copyright{ font-size:.75rem; letter-spacing:.1em; color:var(--light-gray); margin-bottom:var(--space-xs); }
.notice{ font-size:.75rem; color:var(--light-gray); opacity:.6; }

.back-to-top{
  position:fixed;
  bottom:calc(var(--space-lg) + env(safe-area-inset-bottom));
  right:calc(var(--space-md) + env(safe-area-inset-right));
  width:50px; height:50px;
  background:rgba(22,22,34,.92);
  border:2px solid rgba(0,240,255,.85);
  border-radius:50%;
  color:var(--neon-blue);
  font-size:1.5rem;
  cursor:pointer;
  opacity:0;
  visibility:hidden;
  transition:all .3s var(--easing);
  z-index:999;
}
.back-to-top.visible{ opacity:1; visibility:visible; }
.back-to-top:hover{
  background:rgba(0,240,255,.95);
  color:var(--dark-bg);
  box-shadow:0 0 30px rgba(0,240,255,.8);
  transform:translateY(-5px);
}

/* ==========================
   BASE MODAL (기존)
========================== */
.modal{ display:none; position:fixed; inset:0; z-index:2000; align-items:center; justify-content:center; }
.modal.active{ display:flex; }
.modal-overlay{ position:absolute; inset:0; background:rgba(10,10,15,.92); backdrop-filter:blur(20px); }
.modal-content{
  position:relative;
  background:linear-gradient(180deg, rgba(22,22,34,.96), rgba(17,17,26,.78));
  border:1px solid rgba(42,42,53,.9);
  max-width:1000px;
  width:90%;
  max-height:90vh;
  overflow-y:auto;
  border-radius:18px;
  z-index:2001;
  box-shadow:0 26px 120px rgba(0,0,0,.55);
}
.modal-close{
  position:absolute;
  top:18px; right:18px;
  width:40px; height:40px;
  background:transparent;
  border:2px solid rgba(255,0,110,.85);
  border-radius:50%;
  cursor:pointer;
  transition:all .3s var(--easing);
  z-index:2002;
}
.modal-close:hover{
  background:rgba(255,0,110,.95);
  box-shadow:0 0 22px rgba(255,0,110,.75);
  transform:rotate(90deg);
}
.close-line{
  position:absolute; top:50%; left:50%;
  width:20px; height:2px;
  background:rgba(255,0,110,.95);
}
.close-line:first-child{ transform:translate(-50%,-50%) rotate(45deg); }
.close-line:last-child{ transform:translate(-50%,-50%) rotate(-45deg); }

.modal-body{ padding:28px; }
.modal-title{ font-family: 'NeoDonggeunmo'; font-size:2.2rem; margin-bottom:12px; }
.modal-meta{ color:var(--lighter-gray); margin-bottom:18px; }
.modal-description{ font-size:1.05rem; line-height:1.9; color:var(--lighter-gray); margin-bottom:18px; }
.modal-details{ padding-top:18px; border-top:1px solid rgba(42,42,53,.85); }
.modal-image{ width:100%; display:flex; justify-content:center; }
.modal-image img{ max-width:100%; height:auto; border-radius:14px; border:1px solid rgba(42,42,53,.75); }

/* =========================
   BONUS STAGE / OTHER WORKS
========================= */
.ow-grid{
  list-style:none;
  padding:0;
  margin:18px 0 0;
  display:grid;
  gap:12px;
  grid-template-columns:repeat(auto-fit, minmax(340px, 1fr));
  align-items:start;
}
.ow-card{
  border:1px solid rgba(255,255,255,.16);
  border-radius:16px;
  background:rgba(0,0,0,.28);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  transition:transform .15s ease, border-color .15s ease, background .15s ease;
}
.ow-card:hover{
  transform:translateY(-2px);
  border-color:rgba(255,255,255,.28);
  background:rgba(0,0,0,.38);
}
.ow-card-btn{
  all:unset;
  cursor:pointer;
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:16px;
}
.ow-top{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.ow-tag{ font-size:12px; letter-spacing:.14em; opacity:.85; }
.ow-status{ font-size:12px; opacity:.75; white-space:nowrap; }
.ow-title{ font-family: 'NeoDonggeunmo'; margin:0; letter-spacing:.03em; }
.ow-desc{
  margin:0;
  opacity:.78;
  line-height:1.55;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.ow-footer{
  margin-top:auto;
  padding-top:10px;
  border-top:1px solid rgba(255,255,255,.10);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  opacity:.85;
  font-size:12px;
}
.ow-meta, .ow-open{ white-space:nowrap; }
.ow-open{ letter-spacing:.08em; }



/* =========================
   IMAGE LIGHTBOX (Zoom + Pan)
========================= */
.imglb{
  position:fixed;
  inset:0;
  display:none;
  z-index:10000;
}
.imglb.is-open{ display:block; }

.imglb-backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.82);
  z-index:1;
}

.imglb-figure{
  position:relative;
  z-index:2;
  width:min(1200px, calc(100% - 24px));
  height:min(92vh, 900px);
  margin:4vh auto 0;
  border:1px solid rgba(255,255,255,.14);
  border-radius:18px;
  background:rgba(8,10,14,.92);
  overflow:hidden;
}

.imglb-toolbar{
  position:absolute;
  top:10px; left:10px; right:10px;
  display:flex;
  align-items:center;
  gap:8px;
  z-index:2;
}
.imglb-btn{
  height:40px;
  padding:0 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.35);
  color:rgba(255,255,255,.92);
  cursor:pointer;
  user-select:none;
}
.imglb-btn:hover{
  border-color:rgba(0,240,255,.55);
  box-shadow:0 0 18px rgba(0,240,255,.12);
}
.imglb-btn-close{
  margin-left:auto;
  width:44px;
  padding:0;
  font-size:22px;
}
.imglb-pct{
  font-family:var(--font-pixel, monospace);
  font-size:12px;
  letter-spacing:.1em;
  opacity:.85;
  margin-left:4px;
}
.imglb-viewport{
  position:absolute;
  inset:0;
  padding:56px 0 28px;
  overflow:hidden;
  cursor:grab;
  touch-action:none;
}
.imglb-viewport.is-dragging{ cursor:grabbing; }
.imglb-viewport img{
  position:absolute;
  left:0; top:0;
  transform-origin:0 0;
  will-change:transform;
  user-select:none;
  -webkit-user-drag:none;
  max-width:none;
  max-height:none;
}
.imglb-hint{
  position:absolute;
  left:14px;
  bottom:10px;
  margin:0;
  font-size:12px;
  opacity:.7;
  z-index:2;
}





/* =========================
   HUD: NEW MESSAGES CHIP
   - 네 HTML 구조(hud-window) 기준
   - 입력창 위에 떠서 HUD 무드 유지
========================= */

/* hud-window 기준 배치 */
.hero-hud .hud-window{
  position:relative;
  overflow:hidden; /* 기존 유지 */
}

/* 칩이 입력창을 가리지 않도록 hud-lines에 패딩 */
.hero-hud .hud-lines{
  padding-bottom:12px; /* NEW MESSAGES 칩 + 여유 */
}

/* NEW MESSAGES 버튼 */
.hud-newmsg{
  position:absolute;
  left:50%;
  bottom:64px; /* hud-input 위로 띄우기 */
  transform:translateX(-50%) translateY(8px);
  z-index:6;

  display:inline-flex;
  align-items:center;
  gap:10px;

  padding:10px 14px;
  border-radius:14px;

  border:1px solid rgba(0,240,255,.38);
  background:rgba(5,7,11,.72);
  box-shadow:
    0 18px 60px rgba(0,0,0,.45),
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 0 22px rgba(0,240,255,.10);

  font-family:var(--font-pixel);
  font-size:11px;
  letter-spacing:.14em;
  color:rgba(0,240,255,.92);

  cursor:pointer;
  user-select:none;
  -webkit-tap-highlight-color:transparent;

  /* 기본은 숨김 */
  opacity:0;
  visibility:hidden;
  pointer-events:none;

  transition:
    opacity .18s ease,
    transform .18s ease,
    box-shadow .18s ease,
    border-color .18s ease;
}

/* 보이기(JS에서 class 토글) */
.hud-newmsg.is-show{
  opacity:1;
  visibility:visible;
  pointer-events:auto;
  transform:translateX(-50%) translateY(0);
}

/* 스캔라인 */
.hud-newmsg::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius:inherit;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,.06) 0px,
    rgba(255,255,255,.06) 1px,
    transparent 3px,
    transparent 6px
  );
  opacity:.10;
  pointer-events:none;
}

/* 네온 블룸 */
.hud-newmsg::after{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius:inherit;
  background:linear-gradient(90deg,
    rgba(0,240,255,.22),
    rgba(157,0,255,.14),
    rgba(255,0,110,.10)
  );
  filter:blur(14px);
  opacity:.35;
  pointer-events:none;
}

/* hover/active */
.hud-newmsg:hover{
  border-color:rgba(0,240,255,.70);
  box-shadow:
    0 22px 80px rgba(0,240,255,.10),
    0 0 0 1px rgba(255,255,255,.08) inset;
}
.hud-newmsg:active{
  transform:translateX(-50%) translateY(1px) scale(.99);
}

/* 아이콘 */
.hud-newmsg-icon{
  width:22px;
  height:22px;
  display:grid;
  place-items:center;
  border-radius:10px;
  background:rgba(0,240,255,.10);
  border:1px solid rgba(0,240,255,.28);
  color:rgba(0,240,255,.95);
  box-shadow:0 0 16px rgba(0,240,255,.12);
  animation:newMsgBounce 1.2s ease-in-out infinite;
}
@keyframes newMsgBounce{
  0%,100%{ transform:translateY(0); opacity:.95; }
  50%{ transform:translateY(2px); opacity:.75; }
}

/* 텍스트 */
.hud-newmsg-text{
  text-shadow:0 0 14px rgba(0,240,255,.20);
}

/* 카운트 */
.hud-newmsg-count{
  min-width:22px;
  height:22px;
  display:inline-grid;
  place-items:center;
  padding:0 6px;
  border-radius:999px;

  border:1px solid rgba(157,0,255,.55);
  background:rgba(157,0,255,.22);
  color:rgba(255,255,255,.92);
  font-family:var(--font-display);
  font-size:12px;
  letter-spacing:.06em;
  box-shadow:0 0 18px rgba(157,0,255,.15);
}

/* =========================================
   OW MODAL UI (REWORK + RESPONSIVE)
   - 중앙정렬/안잘림/헤더 고정/본문만 스크롤
   - 데스크탑 2컬럼, 모바일 1컬럼
========================================= */

/* overlay */
.ow-modal{
  position:fixed;
  inset:0;
  z-index:9999;
  display:none;
  align-items:center;
  justify-content:center;

  padding:
    calc(14px + env(safe-area-inset-top))
    calc(14px + env(safe-area-inset-right))
    calc(14px + env(safe-area-inset-bottom))
    calc(14px + env(safe-area-inset-left));
}
.ow-modal.is-open{ display:flex; }

.ow-backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.70);
  backdrop-filter: blur(10px);
}

/* panel */
.ow-panel{
  position:relative;
  z-index:2;

  width:min(1040px, 100%);
  max-height: min(92svh, 900px);

  display:flex;
  flex-direction:column;

  border-radius:18px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(8,10,14,.92);
  box-shadow:0 30px 120px rgba(0,0,0,.55);
  overflow:hidden;
}

/* header */
.ow-panel-head{
  flex:0 0 auto;
  padding:16px 16px 14px;
  border-bottom:1px solid rgba(255,255,255,.10);

  background:
    radial-gradient(120% 140% at 20% 0%, rgba(0,240,255,.10), transparent 50%),
    radial-gradient(120% 140% at 80% 10%, rgba(157,0,255,.10), transparent 55%),
    rgba(8,10,14,.78);
  backdrop-filter: blur(12px);
}

.ow-badge{
  display:inline-block;
  margin:0 0 8px;
  font-size:11px;
  letter-spacing:.18em;
  opacity:.85;
  color:rgba(0,240,255,.85);
  font-family:var(--font-pixel);
}

.ow-panel-title{
  margin:0 0 6px;
  font-family:var(--font-display);
  letter-spacing:.02em;
  font-size: clamp(20px, 3vw, 28px);
}

.ow-panel-meta{
  margin:0;
  opacity:.7;
  font-size:13px;
}

.ow-close{
  position:absolute;
  right:12px;
  top:12px;
  width:42px;
  height:42px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.28);
  color:rgba(255,255,255,.92);
  font-size:22px;
  cursor:pointer;
  transition:transform .2s ease, border-color .2s ease, box-shadow .2s ease;
}
.ow-close:hover{
  transform:translateY(-1px);
  border-color:rgba(0,240,255,.55);
  box-shadow:0 0 20px rgba(0,240,255,.14);
}

/* body (only body scrolls) */
.ow-panel-body{
  flex:1 1 auto;
  min-height:0;
  overflow:auto;
  -webkit-overflow-scrolling:touch;

  display:grid;
  grid-template-columns: 1.25fr .9fr;
  gap:14px;

  padding:14px 16px 16px;
}

/* preview */
.ow-preview{
  margin:0;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.28);
  overflow:hidden;

  display:flex;
  flex-direction:column;
  min-height:0;
}

.ow-preview img{
  width:100%;
  height:auto;
  max-height: min(54svh, 560px);
  object-fit:contain;
  display:block;
  background:rgba(0,0,0,.20);
  cursor:zoom-in;
}

/* thumbs */
.ow-thumbs{
  display:flex;
  gap:8px;
  padding:10px;
  border-top:1px solid rgba(255,255,255,.10);
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.ow-thumb{
  width:64px;
  height:64px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.14);
  overflow:hidden;
  cursor:pointer;
  opacity:.7;
  flex:0 0 auto;
  background:rgba(0,0,0,.22);
}
.ow-thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.ow-thumb.active{
  opacity:1;
  border-color:rgba(0,240,255,.65);
  box-shadow:0 0 0 1px rgba(0,240,255,.25) inset;
}

/* info */
.ow-info{
  align-self:start;
  position:sticky;
  top:12px;

  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  padding:14px;
}

.ow-dl{ margin:0; display:grid; gap:12px; }
.ow-row dt{
  font-size:11px;
  letter-spacing:.14em;
  opacity:.75;
  margin-bottom:5px;
  font-family:var(--font-pixel);
}
.ow-row dd{
  margin:0;
  opacity:.92;
  line-height:1.65;
  font-size:14px;
  word-break:keep-all;
}

/* actions */
.ow-actions{ margin-top:12px; }
.ow-link{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:100%;
  text-decoration:none;

  border-radius:12px;
  padding:12px 12px;

  border:1px solid rgba(0,240,255,.35);
  background:rgba(0,240,255,.08);
  color:rgba(0,240,255,.92);

  font-family:var(--font-pixel);
  font-size:11px;
  letter-spacing:.14em;

  transition:transform .18s ease, border-color .18s ease, box-shadow .18s ease;
}
.ow-link:hover{
  transform:translateY(-1px);
  border-color:rgba(0,240,255,.70);
  box-shadow:0 0 22px rgba(0,240,255,.12);
}

/* nav */
.ow-nav{
  margin-top:12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;

  padding-top:12px;
  border-top:1px solid rgba(255,255,255,.10);
}
.ow-nav-btn{
  width:44px;
  height:44px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.20);
  color:rgba(255,255,255,.90);
  font-size:24px;
  cursor:pointer;
  transition:transform .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.ow-nav-btn:hover{
  transform:translateY(-1px);
  border-color:rgba(157,0,255,.55);
  box-shadow:0 0 18px rgba(157,0,255,.10);
}
.ow-nav-text{
  margin:0;
  opacity:.8;
  font-family:var(--font-pixel);
  font-size:11px;
  letter-spacing:.14em;
}

/* ===== Responsive ===== */
@media (max-width: 900px){
  .ow-panel-body{
    grid-template-columns:1fr;
  }
  .ow-info{
    position:static;
    top:auto;
  }
  .ow-preview img{
    max-height: min(46svh, 460px);
  }
}

@media (max-width: 420px){
  .ow-panel-head{ padding:14px 14px 12px; }
  .ow-panel-body{ padding:12px 12px 12px; }
  .ow-thumb{ width:56px; height:56px; }
  .ow-nav-btn{ width:42px; height:42px; }
}




/* =====================================
   OW PREVIEW : CLICK BUTTON UI
===================================== */

/* 기존 커서 돋보기 제거 */
.ow-preview img{
  cursor:default; /* zoom-in 제거 */
}

/* 버튼 기본 */
.ow-img-btn{
  position:absolute;
  inset:0;
  z-index:3;

  display:flex;
  align-items:center;
  justify-content:center;

  background:rgba(5,7,11,.55);
  backdrop-filter:blur(2px);

  border:none;
  color:rgba(255,255,255,.95);
  font-family:var(--font-pixel);
  font-size:12px;
  letter-spacing:.18em;

  opacity:0;
  pointer-events:none;
  transition:opacity .18s ease, transform .18s ease;
}

/* hover 시 버튼 표시 */
.ow-preview:hover .ow-img-btn{
  opacity:1;
  pointer-events:auto;
}

/* 버튼 텍스트 박스 느낌 */
.ow-img-btn::before{
  content:"";
  position:absolute;
  padding:14px 20px;
  border-radius:14px;
  border:1px solid rgba(0,240,255,.55);
  box-shadow:
    0 0 28px rgba(0,240,255,.18),
    inset 0 0 0 1px rgba(255,255,255,.06);
}

/* 텍스트를 위로 */
.ow-img-btn{
  position:absolute;
}
.ow-img-btn span{
  position:relative;
  z-index:1;
}

/* hover 피드백 */
.ow-img-btn:hover::before{
  border-color:rgba(0,240,255,.85);
  box-shadow:0 0 40px rgba(0,240,255,.28);
}




/* =====================================
   

/* thumbs가 안 보이는 상황(높이 0/가려짐) 방지 */
.ow-modal.is-open .ow-panel .ow-preview{
  min-height: 0;
}
.ow-modal.is-open .ow-panel .ow-preview .ow-thumbs{
  display: flex;
  min-height: 92px;
  flex: 0 0 auto;
}






@media (max-width: 1024px),
       (hover: none) and (pointer: coarse) {
  #fxFollower {
    display: none !important;
  }
}




@media (max-width: 1200px){
  /* hero가 들어있는 그리드 컨테이너 후보들 */
  .stage-grid,
  .stages,
  .stages-grid,
  .grid,
  .container-grid,
  .main-grid{
    grid-template-columns: 1fr !important;
  }

  /* hero 카드 자체는 중앙 정렬 */
  .hero-container{
    width: min(92vw, 720px) !important;
    margin: 0 auto !important;
  }
}




/* =========================
   NAV: caret 제거 + active 점멸 추가
   style.css 맨 아래에 추가
========================= */

/* (1) 콘솔 커서(█) 제거 */
.main-nav .nav-menu::after{
  content: "";              /* 기존 " █" 없앰 */
  animation: none !important;
  margin-left: 0;
}

/* (2) active 링크: 점(●)을 왼쪽에 붙이고 깜박이게 */
.main-nav .nav-menu a{
  position: relative;       /* 점 배치를 위해 */      /* 점 들어갈 자리 확보 */
}

/* 점(●) 기본은 숨김 */
.main-nav .nav-menu a::before{
  content: "●";
  position: absolute;
  left: 6%;
  top: 50%;
  transform: translateY(-50%);
  font-size: 8px;
  opacity: 0;
}

/* active일 때만 점 보이고 점멸 */
.main-nav .nav-menu a.is-active::before{
  opacity: 1;
  animation: navDotBlink 1s steps(1, end) infinite;
  display: none;
}

/* 점멸 애니메이션 */
@keyframes navDotBlink{
  50%{ opacity: .1; }
}

/* FINAL은 점 색만 살짝 다르게 */
.main-nav .nav-menu a[href="#final"].is-active::before{
  /* 색을 따로 쓰고 싶으면 이 한 줄만 유지 */
  /* color: rgba(255,0,110,.9); */
}




.main-nav .nav-menu a.is-active::before{
  opacity: 1;
  animation: navDotPulse 1.1s ease-in-out infinite;
}
@keyframes navDotPulse{
  0%,100%{ transform: translateY(-50%) scale(1); opacity: .35; }
  50%{ transform: translateY(-50%) scale(1.15); opacity: 1; }
}




/* =========================
   NAV FIX (1419 wrap + 768 hamburger)
   style.css 맨 아래에 추가
========================= */

/* 1) 1419px부터 깨지는 원인: flex shrink + 링크 줄바꿈
   -> 메뉴는 절대 줄바꿈 금지, 부족하면 가로 스크롤 */
.main-nav .nav-container{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  flex-wrap:nowrap;
}

.main-nav .nav-menu{
  display:flex !important;          /* 768에서 숨김 당해도 복구 */
  flex-wrap:nowrap !important;
  white-space:nowrap;
  overflow-x:auto;                  /* 부족하면 스크롤 */
  -webkit-overflow-scrolling:touch;
  gap:clamp(10px, 1.2vw, 22px);
  align-items:center;
  margin:0;
  padding:10px 14px;
  border-radius:14px;
}

.main-nav .nav-menu li{ flex:0 0 auto; }

.main-nav .nav-menu a{
  white-space:nowrap;               /* 링크 내부 줄바꿈 금지 */
  flex:0 0 auto;
}

/* (선택) 1440 근처에서 더 컴팩트하게 */
@media (max-width: 1440px){
  .main-nav .nav-menu a{ font-size:13px; letter-spacing:.08em; }
  .main-nav .nav-cta{ padding:10px 12px; font-size:13px; }
}

/* 스크롤바 깔끔 */
.main-nav .nav-menu::-webkit-scrollbar{ height:6px; }
.main-nav .nav-menu::-webkit-scrollbar-thumb{
  background:rgba(255,255,255,.18);
  border-radius:999px;
}

/* =========================
   2) 768px 이하: 메뉴 숨기고 햄버거로
========================= */
.nav-burger{
  display:none;
  width:44px;
  height:44px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(10,10,15,.35);
  align-items:center;
  justify-content:center;
  gap:6px;
  flex-direction:column;
  
}
.nav-burger span{
  display:block;
  width:18px;
  height:2px;
  border-radius:999px;
  background:rgba(255,255,255,.85);
}

/* 모바일에선 메뉴/버튼 정리 */
@media (max-width: 768px){
  .main-nav .nav-menu{ display:none !important; } /* 아예 숨김 */
  .main-nav .nav-cta{ display:none; }
  .nav-burger{ display:flex; }
}

/* =========================
   MOBILE PANEL
========================= */
.nav-panel-backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  opacity:0;
  pointer-events:none;
  transition:opacity .2s ease;
  z-index:998;
}

.nav-panel{
  position:fixed;
  top:10px;
  right:10px;
  width:min(360px, calc(100vw - 20px));
  max-height:calc(100vh - 20px);
  background:rgba(10,10,15,.92);
  border:1px solid rgba(255,255,255,.14);
  border-radius:18px;
  backdrop-filter:blur(14px);
  transform:translateX(16px);
  opacity:0;
  pointer-events:none;
  transition:opacity .2s ease, transform .2s ease;
  z-index:999;
  overflow:hidden;
  text-align: center;
  
}

.nav-panel.open{
  opacity:1;
  transform:translateX(0);
  pointer-events:auto;
}
.nav-panel-backdrop.open{
  opacity:1;
  pointer-events:auto;
}

.nav-panel-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px;
  border-bottom:1px solid rgba(255,255,255,.10);
}
.panel-title{
  font-family:var(--font-pixel,'Press Start 2P',monospace);
  letter-spacing:.12em;
  font-size:12px;
  opacity:.9;
}
.panel-close{
  width:36px;
  height:36px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.25);
  color:inherit;
  font-size:20px;
}

.nav-panel-body{
  font-family: var(--font-pixel-kor);
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.panel-hint{
  opacity:.75;
  font-size:12px;
  letter-spacing:.12em;
  text-transform:uppercase;
  margin-bottom:6px;
}

.panel-link{
  display:flex;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);
  text-decoration:none;
  opacity:.9;
}
.panel-link:hover{
  opacity:1;
  box-shadow:0 0 12px rgba(0,240,255,.14);
}
.panel-final{
  border-color:rgba(255,0,110,.22);
}




/* =========================
   1160px 이하: 햄버거 전환
========================= */
@media (max-width: 1160px){
  /* 상단 STAGE 메뉴 숨김 */
  .main-nav .nav-menu{
    display:none !important;
  }

  /* START QUEST 버튼 숨김 */
  .main-nav .nav-cta{
    display:none;
  }

  /* 햄버거 버튼 표시 */
  .nav-burger{
    display:flex;
  }
}




/* =========================
   Hamburger LEFT placement
========================= */

/* nav 컨테이너 기준 */
.main-nav .nav-container{
  position: relative;
  justify-content: flex-start;
}

/* 햄버거를 왼쪽에 */
.nav-burger{
  order: 0;          /* 가장 왼쪽 */
  margin-right: auto;
}

/* 메뉴는 햄버거 오른쪽 (PC에서만 보임) */
.main-nav .nav-menu{
  order: 1;
}

/* 로고는 항상 중앙 */
.main-nav .nav-logo{
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 2;
}

/* START QUEST는 오른쪽 */
.main-nav .nav-cta{
  order: 3;
  margin-left: auto;
}

/* 1160px 이하: 메뉴/CTA 숨김 + 햄버거만 */
@media (max-width: 1160px){
  .main-nav .nav-menu{ display:none !important; }
  .main-nav .nav-cta{ display:none; }
  .nav-burger{ display:flex; }
}




/* =========================
   SAFE CENTER HEADER (GRID)
========================= */

.main-nav .nav-container{
  display:grid;
  grid-template-columns: 1fr auto 1fr;
  align-items:center;
}

/* 왼쪽 메뉴 */
.main-nav .nav-menu{
  justify-self:start;
}

/* 중앙 로고 */
.main-nav .nav-logo{
  position:static;          /* absolute 제거 */
  justify-self:center;
  transform:none;
}

/* 오른쪽 CTA / 햄버거 */
.main-nav .nav-cta,
.nav-burger{
  justify-self:end;
}




/* =========================
   HEADER MODE SWITCH @1259px
========================= */

/* 기본(PC): grid 기반 안전 중앙 */
.main-nav .nav-container{
  display:grid;
  grid-template-columns: 1fr auto 1fr;
  align-items:center;
}

/* 왼쪽 메뉴 */
.main-nav .nav-menu{
  justify-self:start;
}

/* 중앙 로고 */
.main-nav .nav-logo{
  position:static;
  justify-self:center;
  white-space:nowrap; /* 두 줄 방지 */
}

/* 오른쪽 CTA */
.main-nav .nav-cta{
  justify-self:end;
}

/* 햄버거 기본 숨김 */
.nav-burger{
  display:none;
}

/* =========================
   1259px 이하: 햄버거 모드
========================= */
@media (max-width: 1259px){

  /* grid 유지 */
  .main-nav .nav-container{
    grid-template-columns: auto 1fr auto;
  }

  /* STAGE 메뉴 숨김 */
  .main-nav .nav-menu{
    display:none !important;
  }

  /* CTA 숨김 */
  .main-nav .nav-cta{
    display:none;
  }

  /* 햄버거 왼쪽 */
  .nav-burger{
    display:flex;
    justify-self:start;
  }

  /* 로고는 진짜 중앙 */
  .main-nav .nav-logo{
    justify-self:center;
    font-size:clamp(14px, 3.6vw, 18px); /* 줄바꿈 방지용 */
  }
}




/* =========================
   FIX: 1259px 이하에서 로고 진짜 중앙 + 햄버거 왼쪽
========================= */

@media (max-width: 1259px){

  /* 컨테이너를 기준점으로 */
  .main-nav .nav-container{
    position: relative;
    display:flex;                /* grid 해제 */
    align-items:center;
    justify-content:flex-start;
    gap:12px;
  }

  /* 메뉴/CTA는 숨김 */
  .main-nav .nav-menu{ display:none !important; }
  .main-nav .nav-cta{ display:none; }

  /* 햄버거는 왼쪽 고정 */
  .nav-burger{
    display:flex;
    margin-right:auto;
    z-index:3;
  }

  /* 로고를 "진짜 화면 중앙"에 고정 */
  .main-nav .nav-logo{
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
    z-index:2;
    white-space:nowrap;
  }

  /* 로고 글자 크기 살짝 줄여서 깨짐 방지 */
  .main-nav .logo-text{
    font-size:clamp(14px, 4.2vw, 18px);
    letter-spacing:.08em;
  }
}




/* =========================
   MOBILE PANEL: open from LEFT
========================= */

@media (max-width: 1259px){

  /* 백드롭은 그대로 OK */

  /* 패널 위치를 왼쪽으로 */
  .nav-panel{
    left: 10px;
    right: auto;

    /* 오른쪽에서 들어오던 걸, 왼쪽에서 들어오게 */
    transform: translateX(-16px);
  }

  .nav-panel.open{
    transform: translateX(0);
  }
}




/* =========================
   PIXEL DOOR PANEL (LEFT) + PANEL TYPING
========================= */

@media (max-width: 1259px){

  /* 패널: 왼쪽에서 열리고, 슬라이드 대신 "블록 와이프" */
  .nav-panel{
    left: 10px;
    right: auto;

    /* 기존 슬라이드 무시하고, 클립으로 열림 */
    transform: none;
    clip-path: inset(0 100% 0 0);  /* 오른쪽이 가려진 상태(=닫힘) */
    opacity: 1;                    /* clip으로 제어하니 opacity는 고정 */
    pointer-events: none;
  }

  .nav-panel.open{
    pointer-events: auto;
    animation: pixelDoorWipe .28s steps(10, end) both;
  }

  @keyframes pixelDoorWipe{
    from { clip-path: inset(0 100% 0 0); }
    to   { clip-path: inset(0 0 0 0); }
  }

  /* 블록 느낌을 더 주는 오버레이(살짝) */
  .nav-panel::before{
    content:"";
    position:absolute;
    inset:0;
    pointer-events:none;
    opacity:.14;
    background:
      linear-gradient(rgba(255,255,255,.08) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255,255,255,.06) 1px, transparent 1px);
    background-size: 16px 16px; /* 픽셀 그리드 */
    mix-blend-mode: overlay;
  }

  /* 패널 헤더 아래에 타이핑 줄 */
  .panel-typing{
    margin: 0;
    padding: 10px 14px 0;
    font-family: var(--font-pixel, 'Press Start 2P', monospace);
    font-size: 10px;
    letter-spacing: .12em;
    opacity: .85;
    user-select: none;
  }

  .panel-typing .caret{
    display:inline-block;
    margin-left:6px;
    animation: panelCaretBlink 1s steps(1,end) infinite;
    opacity:.9;
  }
  @keyframes panelCaretBlink{
    50%{ opacity:0; }
  }

  /* 패널 바디 상단 여백 살짝 정리 */
  .nav-panel-body{
    padding-top: 10px;
  }
}



/* =========================
   HAMBURGER -> PIXEL X
========================= */
.nav-burger{
  position: relative;
  overflow: hidden;
}

.nav-burger span{
  transition:
    transform .28s steps(6, end),
    opacity .18s steps(2, end),
    top .28s steps(6, end),
    width .28s steps(6, end);
  transform-origin: center;
}

/* X 상태 */
.nav-burger.is-open span:nth-child(1){
  transform: translateY(6px) rotate(45deg);
  width: 20px; /* 픽셀 느낌 */
}
.nav-burger.is-open span:nth-child(2){
  opacity: 0;
}
.nav-burger.is-open span:nth-child(3){
  transform: translateY(-10px) rotate(-45deg);
  width: 20px;
}

/* 살짝 픽셀 네온 */
.nav-burger.is-open{
  border-color: rgba(0,240,255,.35);
  box-shadow: 0 0 18px rgba(0,240,255,.10);
}




/* 부드럽게 떨어지는 기본 상태 */
.drop-section{
  opacity: 0;
  transform: translateY(-24px);
  transition: transform .8s ease, opacity .8s ease;
  will-change: transform, opacity;
}

/* 화면에 보이면 */
.drop-section.is-in{
  opacity: 1;
  transform: translateY(0);
}

/* 모션 줄이기 */
@media (prefers-reduced-motion: reduce){
  .drop-section{ opacity:1; transform:none; transition:none; }
}




/* ===== hover preview tooltip ===== */
.preview-tip{
  position: fixed;
  z-index: 9999;
  width: min(380px, 62vw);
  aspect-ratio: 16 / 9;
  pointer-events: none;
  opacity: 0;
  transform: translateY(8px) scale(.98);
  transition: opacity .12s ease, transform .12s ease;
  border-radius: 14px;
  overflow: hidden;

  background: rgba(8, 10, 18, .72);
  border: 1px solid rgba(0, 240, 255, .35);
  box-shadow:
    0 12px 40px rgba(0,0,0,.55),
    0 0 0 1px rgba(157,0,255,.18),
    0 0 24px rgba(0,240,255,.18);
  backdrop-filter: blur(10px);
}

.preview-tip.is-on{
  opacity: 1;
  transform: translateY(0) scale(1);
}

.preview-tip img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* 작은 캡션(원하면) */
.preview-tip .cap{
  position: absolute;
  left: 10px;
  bottom: 10px;
  font-family: var(--font-display, 'Orbitron', sans-serif);
  font-size: 12px;
  letter-spacing: .06em;
  padding: 6px 10px;
  border-radius: 999px;
  color: rgba(255,255,255,.9);
  background: rgba(0,0,0,.45);
  border: 1px solid rgba(255,255,255,.10);
}

/* 모바일(터치)에서는 hover 개념이 약하니 기본 OFF */
@media (hover: none){
  .preview-tip{ display:none !important; }
}




.preview-tip{
  position: fixed;
  z-index: 9999;
  width: 420px;
  aspect-ratio: 16/9;
  pointer-events: none;
  opacity: 0;
  transform: translateY(10px) scale(.98);
  transition: opacity .12s ease, transform .12s ease;
  border-radius: 14px;
  overflow: hidden;
  background: rgba(5,7,11,.75);
  border: 1px solid rgba(0,240,255,.35);
  box-shadow: 0 16px 60px rgba(0,0,0,.6);
}
.preview-tip.is-on{
  opacity: 1;
  transform: translateY(0) scale(1);
}
.preview-tip img{
  width:100%;
  height:100%;
  object-fit:contain;
}




/* ✅ 카드가 relative여야 내부 absolute 오버레이가 먹음 */
.quest{
  position: relative;
  overflow: hidden;
}

/* hover 시 프리뷰 오버레이 */
.card-preview{
  position:absolute;
  inset: 16px;
  border-radius: 22px;
  background: rgba(5,7,11,.65);
  border: 1px solid rgba(0,240,255,.35);
  box-shadow:
    0 18px 70px rgba(0,0,0,.65),
    0 0 0 1px rgba(255,255,255,.06) inset;
  backdrop-filter: blur(10px);

  display:grid;
  place-items:center;

  opacity:0;
  transform: translateY(10px) scale(.985);
  transition: opacity .18s ease, transform .18s ease;
  pointer-events:none;
  z-index: 5;
}

/* ✅ 카드에 클래스 붙으면 표시 */
.quest.is-preview-on .card-preview{
  opacity:1;
  transform: translateY(0) scale(1);
}

/* 이미지(목업) */
.card-preview img{
  width: min(88%, 980px);
  max-height: 86%;
  object-fit: contain;
  filter: drop-shadow(0 18px 40px rgba(0,0,0,.65));
}

/* PREVIEW 라벨 */
.preview-badge{
  position:absolute;
  left:16px;
  bottom:16px;
  padding:10px 16px;
  border-radius:999px;
  font-family: var(--font-display, 'Orbitron', sans-serif);
  letter-spacing:.08em;
  font-size:18px;
  color: rgba(255,255,255,.92);

  background: rgba(0,0,0,.35);
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 26px rgba(0,0,0,.55);
}




/* =================================
   THEME TOGGLE (Light / Dark)
================================= */

.theme-toggle {
  display: flex;
  align-items: center;
  margin-right: 10px;
}

/* 버튼 바디 */
.theme-switch {
  position: relative;
  width: 74px;
  height: 34px;
  border-radius: 999px;
  border: 2px solid rgba(0, 0, 0, 0.18);
  background: rgba(255, 255, 255, 0.92);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
  cursor: pointer;
  padding: 0 10px;
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  transition:
    transform 0.15s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease,
    background 0.15s ease;
}

.theme-switch:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 22px rgba(0, 0, 0, 0.1);
  border-color: rgba(0, 0, 0, 0.28);
}

.theme-switch:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 4px rgba(66, 120, 255, 0.18),
    0 10px 22px rgba(0, 0, 0, 0.1);
}

/* 아이콘 */
.theme-icon {
  font-size: 15px;
  line-height: 1;
  opacity: 0.6;
  transition: opacity 0.2s ease;
}

/* 동그란 스위치 */
.theme-thumb {
  position: absolute;
  top: 4px;
  left: 4px;
  width: 24px;
  height: 24px;
  border-radius: 999px;
  background: #ffffff;
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.16);
  transition: transform 0.22s ease, background 0.22s ease;
}

/* ===============================
   DARK MODE (aria-checked = true)
=============================== */

.theme-switch[aria-checked="true"] {
  background: rgba(20, 20, 26, 0.92);
  border-color: rgba(255, 255, 255, 0.16);
}

.theme-switch[aria-checked="true"] .theme-thumb {
  transform: translateX(40px);
  background: #11111a;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.38);
}

/* 현재 상태 아이콘 강조 */
.theme-switch[aria-checked="false"] .theme-icon--sun {
  opacity: 1;
}

.theme-switch[aria-checked="true"] .theme-icon--moon {
  opacity: 1;
}




/* =========================
   NAV CTA BUTTONS (WORK LOG / TIMELINE)
   - glass + neon + pixel scanlines
   - .nav-link--cta1 / .nav-link--cta2 전용
   - style.css 맨 아래에 추가
========================= */

/* CTA 줄 정렬 (네가 쓰는 li.nav-cta-row 기준) */
.nav-cta-row{
  display:flex;
  align-items:center;
  gap:10px;
}

/* 기본 버튼 */
.nav-link--cta1,
.nav-link--cta2{
  position:relative;
  display:inline-flex;
  align-items:center;
  justify-content:center;

  padding:8px 32px;
  border-radius:999px;

  text-decoration:none;
  white-space:nowrap;

  font-family: var(--font-pixel-kor), var(--font-body), sans-serif;
  font-size:11px;
  letter-spacing:.14em;

  color:rgba(255,255,255,.92);
  background:rgba(8,10,14,.36);
  border:1px solid rgba(255,255,255,.14);

  box-shadow:
    0 14px 40px rgba(0,0,0,.28),
    inset 0 0 0 1px rgba(255,255,255,.05);

  backdrop-filter: blur(12px);
  -webkit-tap-highlight-color: transparent;

  transition:
    transform .18s var(--easing),
    border-color .18s var(--easing),
    box-shadow .18s var(--easing),
    background .18s var(--easing),
    color .18s var(--easing);
}

/* 스캔라인(픽셀 UI 느낌) */
.nav-link--cta1::before,
.nav-link--cta2::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius:inherit;
  pointer-events:none;

  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,.07) 0px,
    rgba(255,255,255,.07) 1px,
    transparent 3px,
    transparent 6px
  );
  opacity:.10;
}

/* 네온 글로우(버튼 바깥) */
.nav-link--cta1::after,
.nav-link--cta2::after{
  content:"";
  position:absolute;
  inset:-3px;
  border-radius:inherit;
  pointer-events:none;
  filter: blur(14px);
  opacity:.0;
  transition: opacity .18s var(--easing);
}

/* ✅ 작업일기(Blue) */
.nav-link--cta1{
  border-color: rgba(0,240,255,.35);
}
.nav-link--cta1::after{
  background: linear-gradient(90deg,
    rgba(0,240,255,.30),
    rgba(157,0,255,.14),
    rgba(0,240,255,.30)
  );
}

/* ✅ 타임라인(Purple/Pink) */
.nav-link--cta2{
  border-color: rgba(157,0,255,.38);
}
.nav-link--cta2::after{
  background: linear-gradient(90deg,
    rgba(157,0,255,.30),
    rgba(255,0,110,.18),
    rgba(157,0,255,.30)
  );
}

/* hover / active */
.nav-link--cta1:hover,
.nav-link--cta2:hover{
  background: rgba(8,10,14,.50);
  box-shadow:
    0 18px 60px rgba(0,0,0,.36),
    inset 0 0 0 1px rgba(255,255,255,.07);
}
.nav-link--cta1:hover{
  border-color: rgba(0,240,255,.75);
  color: rgba(0,240,255,.95);
  text-shadow: 0 0 14px rgba(0,240,255,.22);
}
.nav-link--cta2:hover{
  border-color: rgba(255,0,110,.65);
  color: rgba(255,255,255,.95);
  text-shadow: 0 0 14px rgba(255,0,110,.18);
}
.nav-link--cta1:hover::after,
.nav-link--cta2:hover::after{
  opacity:.55;
}

.nav-link--cta1:active,
.nav-link--cta2:active{
  transform: translateY(0px) scale(.99);
}

/* 접근성 포커스 */
.nav-link--cta1:focus-visible,
.nav-link--cta2:focus-visible{
  outline:none;
  box-shadow:
    0 0 0 4px rgba(0,240,255,.18),
    0 18px 60px rgba(0,0,0,.36);
}

.nav-link--cta1::marker,
.nav-link--cta2::marker{ content:""; }

.nav-link--cta1 span,
.nav-link--cta2 span{ position:relative; z-index:1; }

.nav-link--cta1::before,
.nav-link--cta2::before{ z-index:0; }
.nav-link--cta1::after,
.nav-link--cta2::after{ z-index:0; }

/* 모바일에서 너무 커 보이면 살짝 컴팩트 */
@media (max-width: 420px){
  .nav-link--cta1,
  .nav-link--cta2{
    height:38px;
    padding:0 12px;
    font-size:10px;
    letter-spacing:.12em;
  }
}




/* =========================
   NAV ACTIONS GROUP (theme + CTAs)
========================= */
.nav-actions{
  display:flex;
  align-items:center;
  gap:10px;
}

/* nav-menu가 가로일 때 오른쪽 끝으로 밀기 (필요한 경우) */
.nav-menu{
  display:flex;
  align-items:center;
  gap: 14px;
}

/* 모바일/태블릿에서 메뉴가 패널로 들어가면 숨기고 싶으면(선택) */
@media (max-width: 1160px){
  /* 네가 이미 1160부터 햄버거 쓰는 흐름이면, 상단 바에서는 오른쪽 그룹 숨김 */
  .nav-menu .nav-actions{
    display:none;
  }
}




/* nav-menu 전체 정렬 */
.main-nav .nav-menu{
  display:flex;
  align-items:center;
  gap:288px;
  margin:0;
  padding:0;
  list-style:none;
}

/* ✅ LEFT 그룹: 한 덩어리(필) */
.main-nav .nav-links a{
  display:flex;
  align-items:center;
}

/* LEFT 그룹 안의 a는 li가 아니라 a라서 여기서 스타일 */
.main-nav .nav-links > a{
  display:inline-flex;
  align-items:center;
  height:28px;
  padding:0 10px;
  border-radius:10px;
  text-decoration:none;
  white-space:nowrap;
}

.main-nav .nav-links > a:hover{
  background: rgba(255,255,255,.06);
}

/* ✅ RIGHT 액션은 오른쪽으로 */
.main-nav .nav-actions a{
  margin-left:auto;
  display:flex;
  align-items:center;
  gap:10px;
}




/* =========================
   NAV: 잘림 제거 + 간격 늘리기 (FINAL OVERRIDE)
   - nav-links를 "왼쪽 그룹"으로 묶어서 gap 컨트롤
   - nav-actions는 오른쪽 끝으로 밀기
   - 화면 좁아지면 가로 스크롤(잘림 대신)
========================= */

/* 0) 컨테이너가 꽉 차도 잘림 없게 */
.main-nav{
  overflow: visible;
}

/* 1) ul(nav-menu): 초대형 gap 제거 + 한 줄 고정 + 스크롤로 안전장치 */
.main-nav .nav-menu{
  display:flex;
  align-items:center;

  gap: 0;                 /* ✅ 288px 같은 고정 gap 제거 */
  margin:0;
  padding:0;
  list-style:none;

  flex-wrap:nowrap;
  white-space:nowrap;

  overflow-x:hidden;        /* ✅ 잘림 대신 스크롤 */
  overflow-y:hidden;
  -webkit-overflow-scrolling:touch;

  min-width:0;            /* ✅ flex overflow 계산 안정화 */
}


/* 2) 왼쪽 그룹(li.nav-links): 여기서 "버튼들 사이 간격" 조절 */
.main-nav .nav-links{
  display:flex;
  align-items:center;
  gap: clamp(12px, 1.2vw, 22px); /* ✅ 메뉴 버튼 사이 간격(원하는 만큼 조절) */
  flex: 0 0 auto;
}

/* 3) 버튼(a) 자체는 가볍게(패딩/높이 통일) */
.main-nav .nav-links > a{
  display:inline-flex;
  align-items:center;
  height: 36px;           /* ✅ pill 높이 */
  padding: 0 22px;        /* ✅ pill 좌우 여백(버튼 크기) */
  border-radius: 999px;
  text-decoration:none;
  white-space:nowrap;
}

/* 혹시 예전 규칙이 a에 flex/padding 크게 주면 무력화 */
.main-nav .nav-links a{
  gap: 0;
}

/* 4) 오른쪽 액션(li.nav-actions): 오른쪽 끝으로 */
.main-nav .nav-actions{
  display:flex;
  align-items:center;
  gap: 10px;
  margin-left:auto;       /* ✅ 오른쪽 끝으로 밀기 */
  flex: 0 0 auto;
  padding-left: 18px;     /* ✅ 왼쪽 그룹과 오른쪽 그룹 사이 간격 */
}

/* 5) "잘리는 것"의 또 다른 주범: nav-container 패딩이 너무 크면 폭이 줄어듦
      네 CSS에 170px까지 커지는 padding이 있어서, 여기서 안전하게 제한 */
.nav-container{
  padding-left: clamp(16px, 3vw, 56px) !important;
  padding-right: clamp(16px, 3vw, 56px) !important;
}




/* =========================
   EXTRA FINAL FX (NAV)
========================= */

/* FINAL 들어가면 살짝 '경보'처럼 반짝이는 틴트 */
.main-nav.is-final{
  animation: finalNavPulse 2.2s ease-in-out infinite;
  position: sticky; /* 이미 fixed면 지워도 됨 */
  top: 0;
  z-index: 9999;
}

@keyframes finalNavPulse{
  0%,100% { filter: saturate(1.05) brightness(1.00); }
  50%     { filter: saturate(1.25) brightness(1.08); }
}

/* 상단에 빨간 경고 라인(엔딩/보스 진입 느낌) */
.main-nav.is-final::before{
  content:"FINAL STAGE • END SEQUENCE • FINAL STAGE • END SEQUENCE •";
  position:absolute;
  left:0; right:0; top:-1px;
  height: 26px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-family: var(--font-pixel, 'Press Start 2P', monospace);
  font-size: 10px;
  letter-spacing: .08em;
  color: rgba(255,255,255,.92);
  background: linear-gradient(90deg,
    rgba(255,0,110,.20),
    rgba(0,240,255,.18),
    rgba(157,0,255,.18),
    rgba(255,0,110,.20)
  );
  border-bottom: 1px solid rgba(255,0,110,.25);
  text-shadow: 0 0 12px rgba(255,0,110,.55);
  overflow:hidden;
  white-space:nowrap;
  animation: finalMarquee 9s linear infinite;
  pointer-events:none;
}

@keyframes finalMarquee{
  0%   { transform: translateX(0);   }
  100% { transform: translateX(-12%); }
}

/* nav 자체가 before 때문에 위로 살짝 올라갈 수 있어서 padding 보정 */
.main-nav.is-final .nav-container{
  padding-top: 10px; /* 이미 padding 있으면 값만 조절 */
}




/* =========================
   FINAL STAGE : RED ACTIVATION
   (no cutscene, no auto scroll)
========================= */

.stage-final{
  position: relative;
  overflow: hidden;
}

/* FINAL 발동 상태 */
.stage-final.is-final-armed{
  filter: saturate(1.1) hue-rotate(-10deg);
}

/* 붉은 오라 + 비네트 */
.stage-final::before{
  content:"";
  position:absolute;
  inset:-12%;
  pointer-events:none;
  opacity:0;
  transition:opacity .4s ease;
  background:
    radial-gradient(
      900px 500px at 50% 30%,
      rgba(255,40,60,.28),
      rgba(0,0,0,0) 55%
    ),
    radial-gradient(
      1200px 900px at 50% 85%,
      rgba(0,0,0,.75),
      rgba(0,0,0,0) 60%
    );
  mix-blend-mode: screen;
}

.stage-final.is-final-armed::before{
  opacity:1;
}

/* FINAL 내부 스캔라인 (섹션 안에서만) */
.stage-final::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  opacity:0;
  transition:opacity .4s ease;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,90,110,.08) 0px,
    rgba(255,90,110,.08) 1px,
    transparent 1px,
    transparent 4px
  );
}

.stage-final.is-final-armed::after{
  opacity:.9;
}

/* FINAL 텍스트 강조 */
.stage-final.is-final-armed
.section-title{
  color:#ff2e4d;
  text-shadow:
    0 0 12px rgba(255,40,60,.55),
    0 0 32px rgba(255,0,80,.25);
}

/* 카드류 붉은 글로우 */
.stage-final.is-final-armed
.drop-section{
  box-shadow:
    0 0 0 rgba(0,0,0,0),
    0 18px 80px rgba(255,30,60,.12);
}




/* =========================
   SECTION ACCENT SYSTEM
   - 섹션마다 --stage-accent만 바꾸면 색상 바뀜
========================= */

/* 기본값(혹시 빠져도 안전) */
.stage{
  --stage-accent: var(--neon-blue);
  --stage-accent-soft: rgba(0,240,255,.18);
}

/* 섹션별로 색만 바꾸기 */
#hero   { --stage-accent: var(--neon-blue);   --stage-accent-soft: rgba(0,240,255,.18); }
#stage1 { --stage-accent: var(--neon-blue); --stage-accent-soft: rgba(157,0,255,.18); }
#stage2 { --stage-accent: var(--neon-blue);  --stage-accent-soft: rgba(57,255,20,.16); }
#stage3 { --stage-accent: var(--neon-blue);   --stage-accent-soft: rgba(255,0,110,.16); }
#stage4 { --stage-accent: var(--neon-purple);   --stage-accent-soft: rgba(0,240,255,.16); }
#final  { --stage-accent: #ff2e4d;            --stage-accent-soft: rgba(255,46,77,.18); }

/* 공통: 섹션 헤더/라인/넘버 */
.stage .section-number{
  color: var(--stage-accent);
  text-shadow: 0 0 14px color-mix(in srgb, var(--stage-accent) 55%, transparent);
}

.stage .section-title{
  color: var(--stage-accent);
  text-shadow:
    0 0 12px color-mix(in srgb, var(--stage-accent) 55%, transparent),
    0 0 30px color-mix(in srgb, var(--stage-accent) 20%, transparent);
}

.stage .title-line{
  background: linear-gradient(
    90deg,
    transparent,
    var(--stage-accent),
    transparent
  );
  box-shadow: 0 0 22px var(--stage-accent-soft);
}

/* 카드/패널에 은은한 accent 라인 */
.stage .drop-section,
.stage .quest,
.stage .panel,
.stage .character-card,
.stage .power-card,
.stage .contact-card{
  position: relative;
}

.stage .drop-section::before,
.stage .quest::before,
.stage .panel::before,
.stage .character-card::before,
.stage .power-card::before,
.stage .contact-card::before{
  content:"";
  position:absolute;
  left:0; top:0; right:0;
  height:2px;
  opacity:.55;
  background: linear-gradient(90deg, transparent, var(--stage-accent), transparent);
  pointer-events:none;
}

/* hover 시 약간 더 살아남 */
.stage .drop-section:hover,
.stage .quest:hover,
.stage .panel:hover,
.stage .power-card:hover,
.stage .contact-card:hover{
  box-shadow: 0 18px 80px color-mix(in srgb, var(--stage-accent) 18%, transparent);
}

/* 태그/칩류도 accent로 */
.stage .card-tag,
.stage .tag,
.stage .quest-type,
.stage .ow-tag{
  color: var(--stage-accent);
  border-color: color-mix(in srgb, var(--stage-accent) 45%, transparent);
  background: color-mix(in srgb, var(--stage-accent) 10%, transparent);
}



/* =========================
   HERO CARD = STAGE1 GLOW FX
   (style.css 맨 아래에 추가)
========================= */

/* hero 카드가 pseudo-element를 쓸 수 있게 */
.hero-container{
  position: relative;
  overflow: hidden;              /* 빛이 카드 밖으로 안 튀게 */
  border-radius: 26px;           /* 기존 카드 라운드랑 비슷하게 */
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(10,12,18,.62); /* 기존 다크 카드 느낌 유지 */
  backdrop-filter: blur(10px);
}

/* 1) 바깥 네온 라인 + 은은한 발광 */
.hero-container::before{
  content:"";
  position:absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events:none;

  /* 네온 테두리 */
  border: 1px solid color-mix(in srgb, var(--stage-accent) 35%, transparent);

  /* glow */
  box-shadow:
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 0 28px color-mix(in srgb, var(--stage-accent) 24%, transparent),
    0 0 70px color-mix(in srgb, var(--stage-accent) 18%, transparent);
  opacity: .95;
}

/* 2) stage1에서 보이던 “모서리 빛 번짐(라이트 블룸)” */
.hero-container::after{
  content:"";
  position:absolute;
  inset: -2px;
  border-radius: inherit;
  pointer-events:none;

  /* 모서리 쪽으로 퍼지는 빛 */
  background:
    radial-gradient(1200px 480px at 50% -10%,
      color-mix(in srgb, var(--stage-accent) 22%, transparent),
      transparent 55%),
    radial-gradient(900px 420px at 0% 0%,
      color-mix(in srgb, var(--stage-accent) 18%, transparent),
      transparent 60%),
    radial-gradient(900px 420px at 100% 0%,
      color-mix(in srgb, var(--stage-accent) 18%, transparent),
      transparent 60%),
    radial-gradient(900px 520px at 50% 120%,
      rgba(0,0,0,.55),
      transparent 55%);

  mix-blend-mode: screen;
  opacity: .75;
  filter: blur(0.2px);
}

/* 3) 살짝 “점등” 느낌 애니메이션 (과하면 숫자 낮춰) */
@keyframes heroGlowPulse{
  0%   { filter: brightness(0.96); }
  50%  { filter: brightness(1.08); }
  100% { filter: brightness(0.98); }
}
@media (prefers-reduced-motion: no-preference){
  .hero-container{
    animation: heroGlowPulse 3.6s ease-in-out infinite;
  }
}

/* 4) 내부 텍스트/컴포넌트가 glow 위에 올라오게 */
.hero-container > *{
  position: relative;
  z-index: 1;
}




/* =========================
   NAV TEXT COLOR (ACTIVE ONLY)
   - 기본: white
   - active: section accent color
========================= */

:root{
  --nav-accent: var(--neon-blue);
  --nav-accent-soft: rgba(0,240,255,.18);
}

/* 기본 메뉴 글자 */
.main-nav .nav-menu a{
  color: rgba(255,255,255,.78);
  opacity: .75;
  transition:
    color .18s ease,
    opacity .18s ease,
    text-shadow .18s ease,
    filter .18s ease;
}

/* hover → 살짝 살아남 */
@media (hover:hover){
  .main-nav .nav-menu a:hover{
    opacity: 1;
    color: rgba(255,255,255,.95);
    text-shadow: 0 0 10px rgba(255,255,255,.25);
  }
}

/* =========================
   현재 섹션(active)
========================= */
.main-nav .nav-menu a.is-active{
  color: var(--nav-accent);
  opacity: 1;
  filter: saturate(1.25) brightness(1.15);
  text-shadow:
    0 0 10px color-mix(in srgb, var(--nav-accent) 55%, transparent),
    0 0 26px color-mix(in srgb, var(--nav-accent) 30%, transparent);
}

/* =========================
   메뉴 아래 네온 라인도 active 색
========================= */
.main-nav::after{
  content:"";
  position:absolute;
  left:0; right:0; bottom:-1px;
  height:1px;
  pointer-events:none;
  background: linear-gradient(
    90deg,
    transparent,
    color-mix(in srgb, var(--nav-accent) 80%, transparent),
    transparent
  );
  opacity:.9;
}




/* =========================
   NAV TEXT = SECTION ACCENT
========================= */

/* nav가 사용할 색(기본값) */
:root{
  --nav-accent: var(--neon-blue);
}

/* 기본 메뉴 글자 */
.main-nav .nav-menu a{
  color: rgba(255,255,255,.55);
  opacity: .75;
  transition: color .18s ease, opacity .18s ease, filter .18s ease, text-shadow .18s ease;
}

/* 현재 섹션(active) 메뉴 글자 = 섹션 색 */
.main-nav .nav-menu a.is-active{
  color: var(--nav-accent);
  opacity: 1;
  filter: saturate(1.3) brightness(1.25);
  text-shadow:
    0 0 10px color-mix(in srgb, var(--nav-accent) 60%, transparent),
    0 0 24px color-mix(in srgb, var(--nav-accent) 35%, transparent),
    0 0 56px color-mix(in srgb, var(--nav-accent) 18%, transparent);
}

/* hover도 살짝 강조 (선택) */
.main-nav .nav-menu a:hover{
  opacity: 1;
}




/* =========================================
   MOBILE PANEL: THEME TOGGLE + CTA
========================================= */

.panel-actions{
  margin: 12px 0 14px;
  padding: 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(10, 12, 18, .35);
  backdrop-filter: blur(10px);
}

.panel-theme{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 12px;
}

.panel-actions-label{
  font-size: 12px;
  letter-spacing: .08em;
  opacity: .8;
}

/* 패널 안 CTA 버튼들 */
.panel-cta{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.panel-cta-link{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 42px;
  border-radius: 12px;
  border: 1px solid rgba(0,240,255,.25);
  text-decoration: none;
  font-size: 13px;
  letter-spacing: .02em;
}

/* 모바일에서는 상단(nav-menu 안) 토글/CTA 숨김 */
@media (max-width: 1260px){
  .nav-actions{ display: none !important; }
}

/* 데스크탑에서는 패널 안 액션 숨김(패널 자체가 안 열릴 수도 있지만 안전하게) */
@media (min-width: 1261px){
  .panel-actions{ display: none; }
}




/* =========================
   ONLY VISIBILITY CONTROL
   - Keep your original styles
========================= */

/* 기본값은 네 기존 CSS를 그대로 따르게 두고,
   브레이크포인트에서 "보이기/숨기기"만 제어 */

/* <=1259: 햄버거 ON, 웹 메뉴 OFF */
@media (max-width: 1259px){
  .nav-burger{ display: inline-flex !important; }
  .nav-menu{ display: none !important; }
}

/* >=1260: 햄버거 OFF, 웹 메뉴 ON (원래 스타일로 복귀) */
@media (min-width: 1260px){
  .nav-burger{ display: none !important; }
  .nav-menu{ display: flex !important; } /* ✅ 원래 display값으로 복구 */
  .nav-actions{ display: flex !important; } /* ✅ 원래 display값으로 복구 */
}

@media (max-width: 1259px){
  .nav-burger{
    position: fixed;
    top: 10px;
    left: 18px;
    z-index: 9999;
  }
}




/* ==========================
   Parallax Stars Background
   - UI 위로 올라오지 않음 (z-index 0)
   - 마우스 움직임에 따라 살짝 이동 + 살짝 기울기
========================== */

.bg-parallax{
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 50;
  overflow: hidden;

  /* default values */
  --tx: 0px;
  --ty: 0px;
  --rx: 0deg;
  --ry: 0deg;
}

/* 레이어 공통 */
.bg-parallax .bg-layer{
  position: absolute;
  inset: -8%;
  display: block;

  transform:
    translate3d(var(--tx), var(--ty), 0)
    rotateX(var(--rx))
    rotateY(var(--ry))
    scale(1.05);

  will-change: transform;
  filter: blur(.2px);
  opacity: .9;
}

/* 1) 먼 배경 (작고 많음) */
.bg-parallax .l1{
  opacity: .35;
  background:
    radial-gradient(circle, rgba(255,255,255,.45) 1px, transparent 2px) 0 0 / 120px 120px,
    radial-gradient(circle, rgba(0,240,255,.22) 1px, transparent 2px) 40px 60px / 160px 160px,
    radial-gradient(circle, rgba(157,0,255,.18) 1px, transparent 2px) 80px 20px / 220px 220px;
  transform:
    translate3d(calc(var(--tx) * .25), calc(var(--ty) * .25), 0)
    rotateX(calc(var(--rx) * .6))
    rotateY(calc(var(--ry) * .6))
    scale(1.06);
}

/* 2) 중간 레이어 (조금 더 큼) */
.bg-parallax .l2{
  opacity: .45;
  background:
    radial-gradient(circle, rgba(255,255,255,.55) 1px, transparent 3px) 0 0 / 180px 180px,
    radial-gradient(circle, rgba(0,240,255,.28) 1px, transparent 3px) 70px 30px / 260px 260px;
  transform:
    translate3d(calc(var(--tx) * .5), calc(var(--ty) * .5), 0)
    rotateX(calc(var(--rx) * .8))
    rotateY(calc(var(--ry) * .8))
    scale(1.07);
}

/* 3) 가까운 레이어 (가장 눈에 띄는 포인트들) */
.bg-parallax .l3{
  opacity: .55;
  background:
    radial-gradient(circle, rgba(255,255,255,.75) 2px, transparent 5px) 0 0 / 320px 320px,
    radial-gradient(circle, rgba(255,0,110,.18) 2px, transparent 6px) 120px 140px / 420px 420px;
  transform:
    translate3d(calc(var(--tx) * .9), calc(var(--ty) * .9), 0)
    rotateX(var(--rx))
    rotateY(var(--ry))
    scale(1.08);
}

/* ✅ 배경 레이어는 맨 뒤 */
.bg-parallax{
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

/* ✅ 헤더는 무조건 위로 */
header, .header, #header, .nav-container{
  position: relative; /* fixed는 기존 CSS가 유지됨 */
  z-index: 9999;
}

/* 모션 최소화 설정 */
@media (prefers-reduced-motion: reduce){
  .bg-parallax .bg-layer{ transform: none !important; }
}

/* 태블릿/모바일에서는 숨기거나 약하게 */
@media (max-width: 1024px){
  .bg-parallax{ display:none; }
}





/* ==========================
   HERO JOYSTICK (outside hero-container)
========================== */
.hero-layout{
  position: relative; /* ✅ joystick absolute 기준 */
}

/* joystick wrapper */
.hero-joystick{
  position: absolute;
  left: clamp(-18px, -1.5vw, 0px);
  bottom: clamp(-22px, -2vw, 6px);
  width: clamp(130px, 14vw, 220px);
  aspect-ratio: 1 / 1;
  z-index: 3;

  pointer-events: none; /* ✅ 클릭 방해 X */

  /* 기본 둥둥 + 살짝 기울기 */
  transform: translate3d(0,0,0) rotate(-6deg) scale(1);
  filter: drop-shadow(0 14px 26px rgba(0,0,0,.45))
          drop-shadow(0 0 18px rgba(0,240,255,.18));

  opacity: .95;

  animation: joystick-float 3.6s ease-in-out infinite;
  will-change: transform, filter;
}

.hero-joystick img{
  width: 100%;
  height: 100%;
  display: block;
  image-rendering: pixelated; /* ✅ 픽셀 느낌 살리기 */
  user-select: none;
}

/* (3) idle 둥둥 애니메이션 */
@keyframes joystick-float{
  0%, 100% { transform: translate3d(0,0,0) rotate(-6deg) scale(1); }
  50%      { transform: translate3d(0,-10px,0) rotate(-4deg) scale(1.02); }
}

/* (2) 근접 반응 상태 (JS가 .is-near 붙임) */
.hero-joystick.is-near{
  animation-play-state: paused; /* 근접하면 float 잠시 멈춰도 좋음 */
  filter: drop-shadow(0 16px 30px rgba(0,0,0,.5))
          drop-shadow(0 0 26px rgba(0,240,255,.42));
}

/* (4) 모바일 대응: 작게 + 아래로 + 더 은은하게 */
@media (max-width: 768px){
  .hero-joystick{
    width: 86px;
    left: 10px;
    bottom: 10px;
    opacity: .6;
    filter: drop-shadow(0 10px 18px rgba(0,0,0,.35))
            drop-shadow(0 0 12px rgba(0,240,255,.14));
  }
}

/* 초소형 화면에서는 숨김 (원하면 opacity 0으로 바꿔도 됨) */
@media (max-width: 1119px){
  .hero-joystick{
    display: none;
  }
}

/* 모션 최소화 설정 존중 */
@media (prefers-reduced-motion: reduce){
  .hero-joystick{
    animation: none;
  }
}



/* ==========================
   HERO ARENA (outside hero-container)
========================== */
.hero-arena{
  position: absolute;
  left: clamp(450px, 52vw, 680px);
  bottom: clamp(-22px, -2vw, 6px);
  width: clamp(150px, 16vw, 240px);
  aspect-ratio: 1 / 1;
  z-index: 5;

  pointer-events: none; /* ✅ 클릭 방해 X */

  /* 기본 둥둥 + 살짝 기울기 */
  transform: translate3d(0,0,0) rotate(-6deg) scale(1);
  filter: drop-shadow(0 14px 26px rgba(0,0,0,.45))
          drop-shadow(0 0 18px rgba(0,240,255,.18));

  opacity: .95;

  animation: arena-float 3.6s ease-in-out infinite;
  will-change: transform, filter;
}

.hero-arena img{
  width: 100%;
  height: 100%;
  display: block;
  image-rendering: pixelated; /* ✅ 픽셀 느낌 살리기 */
  user-select: none;
}

/* (3) idle 둥둥 애니메이션 */
@keyframes arena-float{
  0%, 100% { transform: translate3d(0,0,0) rotate(-6deg) scale(1); }
  50%      { transform: translate3d(0,-10px,0) rotate(-4deg) scale(1.02); }
}

/* (2) 근접 반응 상태 (JS가 .is-near 붙임) */
.hero-arena.is-near{
  animation-play-state: paused; /* 근접하면 float 잠시 멈춰도 좋음 */
  filter: drop-shadow(0 16px 30px rgba(0,0,0,.5))
          drop-shadow(0 0 26px rgba(0,240,255,.42));
}

/* (4) 모바일 대응: 작게 + 아래로 + 더 은은하게 */
@media (max-width: 768px){
  .hero-arena{
    width: 86px;
    left: 10px;
    bottom: 10px;
    opacity: .6;
    filter: drop-shadow(0 10px 18px rgba(0,0,0,.35))
            drop-shadow(0 0 12px rgba(0,240,255,.14));
  }
}

/* 초소형 화면에서는 숨김 (원하면 opacity 0으로 바꿔도 됨) */
@media (max-width: 1119px){
  .hero-arena{
    display: none;
  }
}

/* 모션 최소화 설정 존중 */
@media (prefers-reduced-motion: reduce){
  .hero-arena{
    animation: none;
  }
}



/* ==========================
   RESPONSIVE (GLOBAL)
========================== */
@media (max-width:1200px){
  .hero-layout{
    grid-template-columns:1fr;
    justify-items:center;
  }
  .hero-hud{ display:none !important; }
  .hero-container{ max-width:900px; }
}

@media (max-width:1024px){
  .main-nav{
    padding:
      calc(var(--space-md) + env(safe-area-inset-top))
      var(--stage-padding-x)
      var(--space-md);
  }
  .character-layout{ grid-template-columns:1fr; }
  .skilltree-layout{ grid-template-columns:1fr; }
  .ending{ grid-template-columns:1fr; }
}

/* Tablet/Phone: hide follower cursor */
@media (max-width: 1024px), (hover: none) and (pointer: coarse){
  #fxFollower{ display:none !important; }
}

@media (max-width:768px){
  .nav-menu{ display:none; }
  .hero{
    padding:
      calc(var(--space-xl) + 72px + env(safe-area-inset-top))
      var(--stage-padding-x)
      var(--space-xl);
  }
  .tree-grid{ grid-template-columns:1fr; }
  .quest-grid{ grid-template-columns:1fr; }
}

@media (max-width:420px){
  .ow-grid{ grid-template-columns:1fr; }
  #fxFollower img{ width:110px; }
  .hud-newmsg{ bottom:58px; }
}

/* 접근성: 모션 감소 */
@media (prefers-reduced-motion: reduce){
  *{
    animation-duration:.01ms !important;
    animation-iteration-count:1 !important;
    transition-duration:.01ms !important;
    scroll-behavior:auto !important;
  }
  .fx-cursor-glow{ display:none; }
}




/* ==========================
   HUD FIX: logs scroll + input stays bottom
========================== */

/* HUD 자체 높이 확보 (이미 있으면 덮어쓰기) */
.hero-hud{
  height: min(560px, 72vh);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

/* window가 남은 공간을 전부 먹도록 */
.hero-hud .hud-window{
  flex: 1 1 auto;
  min-height: 0;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

/* ✅ 핵심: 로그 영역이 남은 높이를 차지 + 스크롤 */
.hero-hud .hud-lines{
  flex: 1 1 auto;
  min-height: 0;
  overflow-y: auto;/* 입력창 높이만큼 여유(이미 쓰던 값 유지 가능) */
}

/* ✅ 입력창은 항상 맨 아래 */
.hero-hud .hud-input{
  flex: 0 0 auto;
  margin-top: auto;     /* sticky가 먹통이어도 아래로 붙게 안전장치 */
  position: sticky;
  bottom: 0;
  z-index: 2;
  padding-bottom: calc(12px + env(safe-area-inset-bottom));
}




/* ===============================
   THEME SWITCH UI (STATE-DRIVEN)
   - aria-checked="true" => DARK(ON)
=============================== */

/* 기본(OFF/라이트 쪽) */
.theme-switch{
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;

  width: 72px;
  height: 32px;
  padding: 4px 8px;

  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  backdrop-filter: blur(8px);

  cursor: pointer;
}

.theme-switch .theme-icon{
  font-size: 14px;
  line-height: 1;
  opacity: .7;
}

.theme-switch .theme-thumb{
  position: absolute;
  top: 50%;
  left: 6px;
  width: 22px;
  height: 22px;
  border-radius: 999px;

  transform: translateY(-50%);
  transition: transform .22s ease, box-shadow .22s ease, background .22s ease;

  background: rgba(255,255,255,.92);
  box-shadow: 0 2px 10px rgba(0,0,0,.25);
}

/* ✅ ON(다크) 상태 */
.theme-switch[aria-checked="true"]{
  background: rgba(0,0,0,.45);
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: 0 0 14px rgba(0,240,255,.20);
}

.theme-switch[aria-checked="true"] .theme-thumb{
  transform: translateY(-50%) translateX(34px); /* ← 여기만 네 UI에 맞게 미세조정 */
  background: rgba(255,255,255,.96);
  box-shadow: 0 0 12px rgba(157,0,255,.35), 0 2px 12px rgba(0,0,0,.35);
}

.theme-switch[aria-checked="true"] .theme-icon--sun{
  opacity: .25;
}

.theme-switch[aria-checked="true"] .theme-icon--moon{
  opacity: 1;
  text-shadow: 0 0 10px rgba(157,0,255,.55);
}




/* =========================
   Dark -> Light Clean Wipe
========================= */
.clean-wipe{
  position: fixed; inset: 0;
  z-index: 999999;
  pointer-events: none;
  transform: translateX(-110%);
  opacity: 0;
  background:
    linear-gradient(90deg, rgba(255,255,255,0.96), rgba(255,255,255,0.96)),
    radial-gradient(circle at 30% 30%, rgba(0,0,0,0.04), transparent 55%),
    radial-gradient(circle at 70% 60%, rgba(0,0,0,0.03), transparent 60%);
  box-shadow: 0 0 60px rgba(255,255,255,.25);
}

.clean-hud{
  position: fixed; inset: 0;
  z-index: 1000000;
  pointer-events: none;
  opacity: 0;
  display: grid;
  place-items: center;
}

.clean-hud__text{
  font-family: var(--font-body, 'Inter', sans-serif);
  letter-spacing: .2px;
  font-size: 13px;
  color: rgba(255,255,255,.78);
  background: rgba(0,0,0,.35);
  border: 1px solid rgba(255,255,255,.18);
  padding: 10px 14px;
  border-radius: 999px;
  backdrop-filter: blur(6px);
  transform: translateY(6px);
  opacity: 0;
}

/* 트리거 */
html.to-light .clean-wipe{
  opacity: 1;
  animation: cleanWipeIn 420ms cubic-bezier(.2,.8,.2,1) forwards;
}
@keyframes cleanWipeIn{
  to { transform: translateX(0%); }
}

html.to-light .clean-hud{
  opacity: 1;
}
html.to-light .clean-hud__text{
  animation: cleanTextIn 200ms ease-out forwards;
}
@keyframes cleanTextIn{
  to { opacity: 1; transform: translateY(0); }
}

@media (prefers-reduced-motion: reduce){
  html.to-light .clean-wipe{ animation:none; transform: translateX(0%); opacity:1; }
  html.to-light .clean-hud__text{ animation:none; opacity:1; transform:none; }
}
